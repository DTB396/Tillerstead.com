(()=>{(function(){"use strict";const k={STORAGE_KEY:"tillerstead_app_data",AUTO_SAVE_DELAY:2e3,TOAST_DURATION:4e3,VERSION:"2.0.0",API_BASE_URL:"http://localhost:8000/api",API_TIMEOUT:5e3,API_RETRY_ATTEMPTS:2,COMPANY:{name:"Tillerstead LLC",license:"NJ HIC #13VH10808800",phone:"(609) 862-8808",email:"info@tillerstead.com",website:"tillerstead.com",serviceArea:"South Jersey & Shore Communities"}};function ae(t=document){!t||!t.querySelectorAll||t.querySelectorAll("[data-sqft-helper]").forEach(e=>{if(e.dataset.sqftBound==="1")return;e.dataset.sqftBound="1";const a=e.closest("form")||t,s=e.querySelector('[data-sqft="width"]'),o=e.querySelector('[data-sqft="length"]'),i=e.querySelector('[data-sqft="height"]'),p=e.querySelector('[data-sqft-output="floor"]'),l=e.querySelector('[data-sqft-output="walls"]'),h=e.dataset.targetFloor||"",n=e.dataset.targetWall||"",d=c=>{if(!c)return null;const v=parseFloat(c.value);return Number.isFinite(v)&&v>0?v:null},m=()=>{const c=d(s),v=d(o),_=d(i),y=c&&v?c*v:null,w=c&&v&&_?2*_*(c+v):null;return p&&(p.value=y?y.toFixed(1):"\u2014"),l&&(l.value=w?w.toFixed(1):"\u2014"),{floorSqFt:y,wallSqFt:w}},u=(c,v)=>{if(!c||!v||!Number.isFinite(v))return;const _=a.querySelector(`[name="${c}"]`);_&&(_.value=v.toFixed(1),_.dispatchEvent(new Event("input",{bubbles:!0})),_.dispatchEvent(new Event("change",{bubbles:!0})),_.focus())},b=()=>m();s&&s.addEventListener("input",b),o&&o.addEventListener("input",b),i&&i.addEventListener("input",b),e.querySelectorAll("[data-sqft-action]").forEach(c=>{c.addEventListener("click",()=>{const{floorSqFt:v,wallSqFt:_}=m(),y=c.dataset.sqftAction;y==="use-floor"&&u(h,v),y==="use-walls"&&u(n,_)})}),m()})}const se={license:{type:"NJ Home Improvement Contractor",number:"13VH10808800",status:"Active",verifyUrl:"https://www.njconsumeraffairs.gov/regulated/Pages/Regulated-Business-Verify.aspx"},standards:[{name:"TCNA 2024",desc:"Tile Council of North America Handbook",icon:"\u{1F4D8}"},{name:"ANSI A108/A118",desc:"American National Standards Institute",icon:"\u2705"},{name:"NTCA",desc:"National Tile Contractors Association Methods",icon:"\u{1F3C6}"}],insurance:{type:"General Liability & Workers Comp",status:"Fully Insured"}},Z={tile:[{tip:"Always dry-lay tiles before installing to check pattern and minimize lippage.",source:"TCNA"},{tip:'For large format tile (\u226515"), back-butter plus notch trowel for 95% coverage.',source:"TCNA EJ171"},{tip:"Order 10-15% extra for waste, cuts, and future repairs (attic stock).",source:"Industry Standard"},{tip:'Rectified tile allows tighter grout joints (1/16"-1/8"), non-rectified needs 3/16"+.',source:"ANSI A108"}],mortar:[{tip:"Use polymer-modified thin-set for most applications\u2014better bond and flexibility.",source:"TCNA"},{tip:'Mix to "peanut butter" consistency\u2014mortar should hold ridges without slumping.',source:"NTCA"},{tip:"Let mortar slake 5-10 minutes after mixing, then remix briefly before use.",source:"Manufacturer TDS"},{tip:"Never add water to mortar that has started to set\u2014discard and mix fresh.",source:"TCNA"}],grout:[{tip:'Sanded grout for joints \u22651/8", unsanded for smaller joints to avoid scratching.',source:"TCNA"},{tip:"Wait 24-48 hours after tile installation before grouting (check mortar TDS).",source:"ANSI A108"},{tip:"Seal grout 2-4 weeks after installation when fully cured for stain protection.",source:"Industry Standard"},{tip:"Work in small sections\u2014grout has limited working time before it starts to set.",source:"NTCA"}],leveling:[{tip:"Always prime substrate before SLU\u2014prevents dehydration and improves bond.",source:"Manufacturer TDS"},{tip:'Check floor flatness with 10-ft straightedge\u2014max 1/8" variation for tile.',source:"TCNA"},{tip:"Pour SLU in continuous ribbons and use spike roller to release air bubbles.",source:"NTCA"},{tip:"Temperature matters: SLU needs 50-80\xB0F for proper curing.",source:"Manufacturer TDS"}],slope:[{tip:'Standard shower floor slope is 1/4" per foot toward drain\u2014code minimum.',source:"IPC/IRC"},{tip:"Pre-slope under membrane, then sloped mortar bed on top for proper drainage.",source:"TCNA B422"},{tip:"Use a level and slope gauge to verify consistent pitch across entire floor.",source:"NTCA"}],waterproof:[{tip:"Apply liquid membrane in 2 coats at 90\xB0 angles for complete coverage.",source:"Manufacturer TDS"},{tip:"Embed reinforcing fabric in corners, seams, and transitions per TCNA.",source:"TCNA B422"},{tip:"Flood test shower pan for 24 hours before installing tile.",source:"IPC/Local Code"},{tip:'Extend waterproofing 3"+ above showerhead height on walls.',source:"TCNA B422"}],"heated-floor":[{tip:"Radiant heat requires dedicated circuit\u2014verify load with electrician.",source:"NEC"},{tip:"Use modified thin-set rated for radiant heat applications.",source:"TCNA"},{tip:"Wait 28 days after installation before energizing heat system.",source:"Manufacturer TDS"}],deflection:[{tip:"Natural stone requires L/720 deflection; ceramic/porcelain allows L/360.",source:"TCNA F150"},{tip:'Add 1/4" cement board over subfloor to increase stiffness and flatness.',source:"TCNA F144"},{tip:"Joist sistering or blocking may be needed to meet deflection requirements.",source:"TCNA"}],labor:[{tip:"Account for substrate prep, waterproofing, and curing time in schedule.",source:"Industry Standard"},{tip:"Complex patterns (herringbone, chevron) take 2-3x longer than straight lay.",source:"NTCA"},{tip:"Large format tile requires more precision and time\u2014plan accordingly.",source:"TCNA"}],moisture:[{tip:"Concrete must cure 28 days minimum before moisture testing.",source:"ASTM F2170"},{tip:"RH >75% or MVER >5 lbs requires moisture mitigation before flooring.",source:"ASTM F1869"},{tip:"Test multiple locations\u2014moisture varies across slab, especially near walls.",source:"ASTM F2170"}]};function U(t){const e=Z[t];return!e||e.length===0?null:e[Math.floor(Math.random()*e.length)]}function ue(t){return Z[t]||[]}const ie={homedepot:{name:"Home Depot",icon:"\u{1F3E0}",color:"#f96302",searchUrl:t=>`https://www.homedepot.com/s/${encodeURIComponent(t)}`},lowes:{name:"Lowe's",icon:"\u{1F535}",color:"#004990",searchUrl:t=>`https://www.lowes.com/search?searchTerm=${encodeURIComponent(t)}`},flooranddecor:{name:"Floor & Decor",icon:"\u{1F3EA}",color:"#00a651",searchUrl:t=>`https://www.flooranddecor.com/search?q=${encodeURIComponent(t)}`},amazon:{name:"Amazon",icon:"\u{1F4E6}",color:"#ff9900",searchUrl:t=>`https://www.amazon.com/s?k=${encodeURIComponent(t)}&tag=tillerstead-20`},msi:{name:"MSI Surfaces",icon:"\u{1F48E}",color:"#1a1a1a",searchUrl:t=>`https://www.msisurfaces.com/search?q=${encodeURIComponent(t)}`},daltile:{name:"Daltile",icon:"\u{1F537}",color:"#003366",searchUrl:t=>`https://www.daltile.com/search?search=${encodeURIComponent(t)}`}},ee={tile:t=>{const e=t.tileWidth&&t.tileHeight?`${t.tileWidth}x${t.tileHeight}`:"";return e?`${e} porcelain tile`:"porcelain floor tile"},mortar:t=>t.backButter?"large format thin-set mortar":"thin-set mortar 50lb",grout:t=>(t.jointWidth||.125)>.125?"sanded grout":"unsanded grout",leveling:()=>"self-leveling underlayment",waterproof:t=>t.membraneType==="sheet"?"kerdi membrane":"redgard waterproofing",slope:()=>"deck mud mortar mix","heated-floor":t=>`radiant floor heat mat ${t.voltage||120}v`,deflection:()=>"floor leveling compound","thinset-mix":()=>"thin-set mortar",primer:()=>"concrete primer SLU","deck-mud":()=>"deck mud mortar sand mix",sealant:()=>"silicone caulk bathroom",sealer:t=>t.surface==="natural_stone"?"natural stone sealer":"grout sealer",movement:()=>"tile expansion joint",moisture:()=>"moisture barrier concrete","bath-layout":()=>"bathroom fixtures",labor:()=>"tile installation tools",crown:()=>"crown molding",baseboard:()=>"baseboard molding MDF",quarter:()=>"quarter round trim"};function le(t,e){const a=ee[t];if(!a)return[];const s=a(e||{}),o=[];return(t==="tile"?["homedepot","lowes","flooranddecor","msi","daltile"]:["homedepot","lowes","amazon"]).forEach(p=>{const l=ie[p];l&&o.push({id:p,name:l.name,icon:l.icon,color:l.color,url:l.searchUrl(s),searchTerm:s})}),o}const L=[{id:"tile",name:"Tile Quantity",icon:"\u{1F9F1}",desc:"Tiles and boxes needed",tooltip:"Calculate exact tile count with waste factors for different layouts. Supports mosaic sheets and large-format tile (LFT).",category:"coverage",status:"ready"},{id:"mortar",name:"Mortar Coverage",icon:"\u{1F527}",desc:"Thin-set bags needed",tooltip:"Estimate mortar bags based on trowel size. Automatically adds 25% for back-buttering LFT per TCNA standards.",category:"coverage",status:"ready"},{id:"grout",name:"Grout Calculator",icon:"\u{1FAA3}",desc:"Grout volume & bags",tooltip:"Calculate grout needed based on tile size, joint width, and depth using TCNA formula. 10% waste included.",category:"coverage",status:"ready"},{id:"waterproof",name:"Waterproofing",icon:"\u{1F4A7}",desc:"Membrane coverage",tooltip:"Calculate liquid membrane gallons and reinforcing band feet for showers, tub surrounds, and wet areas.",category:"coverage",status:"ready"},{id:"slope",name:"Shower Slope",icon:"\u{1F4D0}",desc:"Pre-slope rise & volume",tooltip:'Calculate shower floor pre-slope dimensions and deck mud volume. Standard is \xBC" per foot to drain.',category:"structural",status:"ready"},{id:"deflection",name:"Structure Deflection",icon:"\u{1F3D7}\uFE0F",desc:"L/360 or L/720 check",tooltip:"Verify floor joist deflection meets TCNA requirements. Natural stone requires L/720, ceramic L/360.",category:"structural",status:"ready"},{id:"heated-floor",name:"Heated Floor Load",icon:"\u2668\uFE0F",desc:"Watts, amps, breaker",tooltip:"Calculate electrical load for radiant floor heating. Determines amp draw and breaker/thermostat requirements.",category:"structural",status:"ready"},{id:"leveling",name:"Self-Leveling",icon:"\u{1F4CF}",desc:"SLU compound amounts",tooltip:"Calculate self-leveling underlayment (SLU) bags needed based on pour depth and area.",category:"prepfinish",status:"ready"},{id:"thinset-mix",name:"Thinset Mixing",icon:"\u{1F300}",desc:"Water ratio & yield",tooltip:"Calculate water-to-powder ratio and batch yield per TDS specs. Includes pot life guidance.",category:"prepfinish",status:"ready"},{id:"primer",name:"Primer / SLU Prep",icon:"\u{1F9F4}",desc:"Coat coverage",tooltip:"Estimate primer gallons for porous vs non-porous substrates. Supports double-priming calculations.",category:"prepfinish",status:"ready"},{id:"deck-mud",name:"Deck Mud",icon:"\u{1F3D4}\uFE0F",desc:"Pan volume & bags",tooltip:"Calculate dry-pack mortar for shower pans and beds. Accounts for slope and minimum thickness.",category:"prepfinish",status:"ready"},{id:"sealant",name:"Sealant / Caulk",icon:"\u{1F9F5}",desc:"Tubes needed",tooltip:"Calculate caulk/sealant tubes based on linear feet and bead diameter. Supports 10.1oz and 28oz sizes.",category:"prepfinish",status:"ready"},{id:"sealer",name:"Sealer Coverage",icon:"\u{1F6E1}\uFE0F",desc:"Gallons by porosity",tooltip:"Estimate sealer gallons based on surface porosity (natural stone, grout, concrete) and coat count.",category:"prepfinish",status:"ready"},{id:"movement",name:"Movement Joints",icon:"\u2194\uFE0F",desc:"EJ171 spacing grid",tooltip:"Calculate expansion joint spacing per TCNA EJ171. Accounts for interior/exterior exposure and temperature swing.",category:"other",status:"ready"},{id:"moisture",name:"Moisture / RH",icon:"\u{1F4A8}",desc:"ASTM F1869/F2170",tooltip:"Evaluate moisture vapor emission rate (MVER) and relative humidity (RH) against adhesive/coating limits.",category:"other",status:"ready"},{id:"bath-layout",name:"Bath Layout",icon:"\u{1F6C1}",desc:"Fixture clearances",tooltip:"Plan bathroom fixture placement with IPC code-compliant clearances for tub, toilet, vanity, and shower.",category:"other",status:"ready"},{id:"labor",name:"Labor Estimate",icon:"\u23F1\uFE0F",desc:"Time & scheduling",tooltip:"Estimate installation time based on area, complexity, and additional work (prep, demo).",category:"other",status:"ready"},{id:"crown",name:"Crown Molding",icon:"\u{1F451}",desc:"Trim & corners",tooltip:"Calculate crown molding pieces, inside/outside corners, and material costs by profile size.",category:"other",status:"ready"},{id:"baseboard",name:"Baseboard",icon:"\u{1F4CB}",desc:"Wall base & chair rail",tooltip:"Calculate baseboard with door/window deductions. Includes wainscoting panel framing option.",category:"other",status:"ready"},{id:"quarter",name:"Quarter Round",icon:"\u{1F518}",desc:"Floor trim",tooltip:"Calculate quarter round or shoe molding with deductions for doors, cabinets, and transitions.",category:"other",status:"ready"}],te={coverage:{name:"Surface Coverage",icon:"\u{1F9F1}",order:1,desc:"Calculate tile, mortar, grout, and waterproofing materials",longDesc:"Essential calculators for determining material quantities with built-in waste factors and TCNA compliance."},structural:{name:"Structural & Load",icon:"\u{1F3D7}\uFE0F",order:2,desc:"Verify substrate requirements and electrical loads",longDesc:"Check floor deflection, shower slopes, and heated floor electrical requirements before installation."},prepfinish:{name:"Prep & Finishing",icon:"\u{1F9F4}",order:3,desc:"Surface prep, mixing ratios, and finishing products",longDesc:"Calculate leveling compound, mixing ratios, primers, sealants, and sealers for proper surface preparation."},other:{name:"Planning & Layout",icon:"\u{1F4D0}",order:4,desc:"Project planning, layout, and trim work",longDesc:"Plan bathroom layouts, movement joints, moisture testing, labor estimates, and trim/molding calculations."}},W=[{id:"mosaic-1x1",name:"1\xD71 Mosaic (12\xD712 sheet)",width:1,height:1,isMosaic:!0,sheetCoverage:1},{id:"mosaic-2x2",name:"2\xD72 Mosaic (12\xD712 sheet)",width:2,height:2,isMosaic:!0,sheetCoverage:1},{id:"3x6",name:"3\xD76 Subway",width:3,height:6},{id:"4x4",name:"4\xD74",width:4,height:4},{id:"4x12",name:"4\xD712",width:4,height:12},{id:"6x6",name:"6\xD76",width:6,height:6},{id:"6x24",name:"6\xD724 Plank",width:6,height:24,isPlank:!0,isLargeFormat:!0},{id:"8x48",name:"8\xD748 Plank",width:8,height:48,isPlank:!0,isLargeFormat:!0},{id:"12x12",name:"12\xD712",width:12,height:12},{id:"12x24",name:"12\xD724",width:12,height:24,isLargeFormat:!0},{id:"12x48",name:"12\xD748 Plank",width:12,height:48,isPlank:!0,isLargeFormat:!0},{id:"24x24",name:"24\xD724",width:24,height:24,isLargeFormat:!0},{id:"24x48",name:"24\xD748",width:24,height:48,isLargeFormat:!0},{id:"custom",name:"Custom Size",width:0,height:0,isCustom:!0}],J=[{id:"straight",name:"Straight / Stacked",waste:10,wasteFactor:.1},{id:"subway-33",name:"1/3 Offset (Recommended for LFT)",waste:12,wasteFactor:.12,lftSafe:!0},{id:"subway-50",name:"50% Offset (Brick)",waste:15,wasteFactor:.15,lippageRisk:!0,lftWarning:"NOT recommended for LFT\u2014max 33% offset per TCNA"},{id:"brick",name:"Running Bond",waste:12,wasteFactor:.12},{id:"diagonal",name:"Diagonal",waste:18,wasteFactor:.18},{id:"herringbone",name:"Herringbone",waste:25,wasteFactor:.25},{id:"mosaic",name:"Mosaic Sheet",waste:12,wasteFactor:.12}],V=[{id:"3/16-v",name:'3/16" V-Notch',min:100,max:130,forTiles:"mosaic, small wall"},{id:"1/4-sq",name:'1/4" \xD7 1/4" Square',min:90,max:100,forTiles:"up to 8\xD78"},{id:"1/4x3/8-sq",name:'1/4" \xD7 3/8" Square',min:60,max:67,forTiles:"8\xD78 to 13\xD713"},{id:"1/2-sq",name:'1/2" \xD7 1/2" Square',min:42,max:47,forTiles:"not recommended for LFT",notForLFT:!0},{id:"3/4-u-45",name:'3/4" \xD7 9/16" U-Notch @ 45\xB0',min:34,max:38,forTiles:'LFT \u226515"',forLFT:!0},{id:"3/4-u-30",name:'3/4" \xD7 9/16" U-Notch @ 30\xB0',min:42,max:47,forTiles:'LFT \u226515" (best)',forLFT:!0,recommended:!0}],me=[{id:"1/16",name:'1/16" (minimum)',size:.0625,note:"Absolute minimum per ANSI"},{id:"1/8",name:'1/8" (rectified)',size:.125,note:"Standard for rectified tile"},{id:"3/16",name:'3/16" (calibrated)',size:.1875,note:"Standard for non-rectified"},{id:"1/4",name:'1/4" (rustic/handmade)',size:.25,note:"Handmade/high-variation tile"}],oe=1.86,G=.45,Q=[{id:"2.25-finger",name:'2-1/4" Finger-Joint Pine',size:2.25,material:"pine",pricePerFt:1.25,paintGrade:!0},{id:"3.25-mdf",name:'3-1/4" MDF',size:3.25,material:"mdf",pricePerFt:1.5,paintGrade:!0},{id:"3.625-pine",name:'3-5/8" Pine',size:3.625,material:"pine",pricePerFt:2,paintGrade:!0},{id:"4.625-pine",name:'4-5/8" Pine',size:4.625,material:"pine",pricePerFt:3.25,paintGrade:!0},{id:"5.25-poplar",name:'5-1/4" Poplar',size:5.25,material:"poplar",pricePerFt:4.5,paintGrade:!0},{id:"4.5-oak",name:'4-1/2" Red Oak',size:4.5,material:"oak",pricePerFt:6.5,stainGrade:!0},{id:"custom",name:"Custom Size",size:0,isCustom:!0}],Y=[{id:"3.25-mdf",name:'3-1/4" MDF Baseboard',size:3.25,type:"baseboard",pricePerFt:.85},{id:"4.25-mdf",name:'4-1/4" MDF Baseboard',size:4.25,type:"baseboard",pricePerFt:1.1},{id:"5.25-mdf",name:'5-1/4" MDF Baseboard',size:5.25,type:"baseboard",pricePerFt:1.35},{id:"6-mdf",name:'6" MDF Baseboard',size:6,type:"baseboard",pricePerFt:1.65},{id:"7.25-mdf",name:'7-1/4" MDF Baseboard',size:7.25,type:"baseboard",pricePerFt:2.1},{id:"2.5-chair",name:'2-1/2" Chair Rail',size:2.5,type:"chair",pricePerFt:1.75},{id:"3-chair",name:'3" Chair Rail',size:3,type:"chair",pricePerFt:2.25},{id:"custom",name:"Custom Size",size:0,isCustom:!0}],K=[{id:"0.5-pine",name:'1/2" Pine Quarter Round',size:.5,material:"pine",pricePerFt:.45},{id:"0.75-pine",name:'3/4" Pine Quarter Round',size:.75,material:"pine",pricePerFt:.65},{id:"0.75-mdf",name:'3/4" MDF Quarter Round',size:.75,material:"mdf",pricePerFt:.55},{id:"0.5-shoe",name:'1/2" \xD7 3/4" Shoe Molding',size:.5,material:"pine",pricePerFt:.55,isShoe:!0},{id:"0.75-oak",name:'3/4" Red Oak Quarter Round',size:.75,material:"oak",pricePerFt:1.85},{id:"custom",name:"Custom Size",size:0,isCustom:!0}],X=[{id:"8",name:"8 ft",length:8},{id:"10",name:"10 ft",length:10},{id:"12",name:"12 ft",length:12},{id:"16",name:"16 ft",length:16}],E={simple:.1,moderate:.15,complex:.2,coffered:.25},r={currentRoute:"dashboard",projects:[],activeProject:null,activeCalculator:"tile",searchQuery:"",settings:{autoSave:!0,autoCreateProject:!0,notifications:!0,darkMode:!0,units:"imperial"},calculatorInputs:{},calculatorResults:{},lastAutoSave:null,shopLinksClicked:[]},T={save(){try{const t={projects:r.projects,settings:r.settings,version:k.VERSION};return localStorage.setItem(k.STORAGE_KEY,JSON.stringify(t)),!0}catch(t){return console.error("Storage save failed:",t),!1}},load(){try{const t=localStorage.getItem(k.STORAGE_KEY);if(t){const e=JSON.parse(t);return r.projects=e.projects||[],r.settings={...r.settings,...e.settings},!0}}catch(t){console.error("Storage load failed:",t)}return!1},exportData(){const t={exportDate:new Date().toISOString(),version:k.VERSION,projects:r.projects,settings:r.settings},e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),a=URL.createObjectURL(e),s=document.createElement("a");s.href=a,s.download=`tillerpro-export-${Date.now()}.json`,s.click(),URL.revokeObjectURL(a),g.show("Data exported successfully","success")},importData(t){const e=new FileReader;e.onload=a=>{try{const s=JSON.parse(a.target.result);s.projects&&(r.projects=s.projects,T.save(),j.navigate(r.currentRoute),g.show(`Imported ${s.projects.length} projects`,"success"))}catch(s){g.show("Invalid import file","error")}},e.readAsText(t)}},F={isConnected:!1,lastHealthCheck:null,async checkHealth(){try{const t=new AbortController,e=setTimeout(()=>t.abort(),k.API_TIMEOUT),a=await fetch(`${k.API_BASE_URL.replace("/api","")}/health`,{signal:t.signal});if(clearTimeout(e),a.ok)return this.isConnected=!0,this.lastHealthCheck=Date.now(),this.updateConnectionUI(!0),!0}catch(t){this.isConnected=!1,this.updateConnectionUI(!1)}return!1},updateConnectionUI(t){const e=document.getElementById("api-status");e&&(e.className=t?"api-status api-status--connected":"api-status api-status--offline",e.title=t?"Connected to Toolkit API":"Offline Mode (Local Calculations)",e.innerHTML=t?'<span class="api-status__dot"></span><span>API</span>':'<span class="api-status__dot"></span><span>Offline</span>')},async request(t,e={}){if(!this.isConnected)throw new Error("API not connected");const a=`${k.API_BASE_URL}${t}`,s={headers:{"Content-Type":"application/json",...e.headers},...e};for(let o=0;o<k.API_RETRY_ATTEMPTS;o++)try{const i=new AbortController,p=setTimeout(()=>i.abort(),k.API_TIMEOUT),l=await fetch(a,{...s,signal:i.signal});if(clearTimeout(p),!l.ok)throw new Error(`HTTP ${l.status}`);return await l.json()}catch(i){if(o===k.API_RETRY_ATTEMPTS-1)throw i;await new Promise(p=>setTimeout(p,500*(o+1)))}},async listJobs(){return this.request("/jobs")},async getJob(t){return this.request(`/jobs/${t}`)},async createJob(t){return this.request("/jobs",{method:"POST",body:JSON.stringify(t)})},async updateJob(t,e){return this.request(`/jobs/${t}`,{method:"PATCH",body:JSON.stringify(e)})},async deleteJob(t){return this.request(`/jobs/${t}`,{method:"DELETE"})},async listRooms(t){return this.request(`/jobs/${t}/rooms`)},async createRoom(t,e){return this.request("/rooms",{method:"POST",body:JSON.stringify({job_id:t,...e})})},async listCalculators(){return this.request("/calculators")},async calculate(t,e){return this.request(`/calculators/${t}/calculate`,{method:"POST",body:JSON.stringify(e)})},async searchProducts(t,e=null){const a=new URLSearchParams({q:t});return e&&a.append("category",e),this.request(`/products/search?${a}`)},async exportBOM(t,e="json"){return this.request(`/exports/bom/${t}?format=${e}`)}},re={apiTypeMap:{tile:"tile_floor",mortar:"thinset_mortar",grout:"grout",leveling:"self_leveler",slope:"shower_slope",waterproof:"waterproofing",movement:"movement_joints",deflection:"deflection","heated-floor":"heated_floor",moisture:"moisture_check","thinset-mix":"thinset_mix",sealer:"sealer","deck-mud":"deck_mud",primer:"primer",sealant:"sealant","bath-layout":"bath_layout",labor:"labor"},async calculate(t,e){const a=this.apiTypeMap[t];if(F.isConnected&&a)try{const s=await F.calculate(a,this.transformInputsForAPI(t,e));return this.transformResultFromAPI(s)}catch(s){console.warn(`API calculation failed for ${t}, using local:`,s.message)}return Calculators[t](e)},transformInputsForAPI(t,e){var a;switch(t){case"tile":return{area_sqft:e.area,tile_length_in:e.tileWidth,tile_width_in:e.tileHeight,waste_percent:e.waste,round_up_to_box:!0,tiles_per_box:e.tilesPerBox||10,include_mortar:!1,include_grout:!1};case"mortar":return{area_sqft:e.area,trowel_notch_size:e.trowelSize,back_butter:e.backButter||!1};case"movement":return{length_ft:e.length||e.lengthFt,width_ft:e.width||e.widthFt,exposure:e.exposure||"interior",temp_swing_f:(a=e.tempSwingF)!=null?a:30,sun_exposed:e.isSunExposed||!1};case"deflection":return{span_ft:e.spanFeet,joist_spacing_in:e.joistSpacingInches,joist_width_in:e.joistWidthInches,joist_depth_in:e.joistDepthInches,modulus_psi:e.modulusPsi||16e5,live_load_psf:e.liveLoadPsft||40,dead_load_psf:e.deadLoadPsft||10};case"heated-floor":return{area_sqft:e.areaSqFt||e.area,watts_per_sqft:e.wattsPerSqFt||12,voltage:e.voltage||120,thermostat_max_amps:e.thermostatMaxAmps||15};case"moisture":return{mver_lbs:e.mverLbs,rh_percent:e.rhPercent,limit_mver:e.productLimitMver||5,limit_rh:e.productLimitRh||75};case"thinset-mix":return{bag_weight_lbs:e.bagWeightLbs||50,water_quarts_min:e.waterQuartsPerBagMin||5,water_quarts_max:e.waterQuartsPerBagMax||6,batch_weight_lbs:e.batchWeightLbs,pot_life_min:e.potLifeMinutes||120,yield_cuft_per_bag:e.yieldCuFtPerBag||.45};case"sealer":return{area_sqft:e.areaSqFt||e.area,surface:e.surface||"natural_stone",coats:e.coats||2};case"deck-mud":return{area_sqft:e.areaSqFt||e.area,run_ft:e.runFeet,min_thickness_in:e.minThicknessInches||1.25,slope_in_per_ft:e.slopeInchesPerFoot||.25,bag_yield_cuft:e.bagYieldCuFt||.5};case"primer":return{area_sqft:e.areaSqFt||e.area,porosity:e.porosity||"porous",double_prime:e.doublePrime||!1};case"sealant":return{linear_ft:e.linearFeet,bead_diameter_in:e.beadDiameterInches||.25,tube_volume_oz:e.tubeVolumeOz||10.1};default:return e}},transformResultFromAPI(t){return{...t.summary,lineItems:t.line_items,formulas:t.formulas_used,source:"api"}}},j={routes:{dashboard:()=>M.dashboard(),calculators:()=>M.calculators(),projects:()=>M.projects(),settings:()=>M.settings()},init(){window.addEventListener("hashchange",()=>this.handleRoute()),this.handleRoute()},handleRoute(){const e=(window.location.hash.slice(2)||"dashboard").split("/")[0];this.routes[e]?(r.currentRoute=e,this.routes[e](),this.updateNav(),this.updateTitle()):this.navigate("dashboard")},navigate(t){window.location.hash=`/${t}`},updateNav(){document.querySelectorAll("[data-route]").forEach(t=>{const e=t.dataset.route===r.currentRoute;t.classList.toggle("is-active",e)})},updateTitle(){const t={dashboard:"Dashboard",calculators:"Calculators",projects:"Projects",settings:"Settings"},e=document.getElementById("page-title");e&&(e.textContent=t[r.currentRoute]||"TillerPro")}},g={show(t,e="info",a=k.TOAST_DURATION){const s=document.getElementById("toast-container"),o={success:"\u2713",error:"\u2715",warning:"\u26A0",info:"\u2139"},i=document.createElement("div");return i.className=`toast toast--${e}`,i.innerHTML=`
        <span class="toast__icon">${o[e]}</span>
        <div class="toast__content">
          <span class="toast__message">${t}</span>
        </div>
        <button class="toast__close" aria-label="Close">\xD7</button>
      `,i.querySelector(".toast__close").addEventListener("click",()=>this.dismiss(i)),s.appendChild(i),a>0&&setTimeout(()=>this.dismiss(i),a),i},dismiss(t){t.style.opacity="0",t.style.transform="translateX(100%)",setTimeout(()=>t.remove(),300)}},I={show(t){const{title:e,body:a,footer:s,onClose:o}=t,i=document.getElementById("modal-overlay"),p=document.getElementById("modal");document.getElementById("modal-title").textContent=e,document.getElementById("modal-body").innerHTML=a,document.getElementById("modal-footer").innerHTML=s||"",i.hidden=!1,p.querySelector(".modal__close").focus(),this._onClose=o,document.body.style.overflow="hidden"},hide(){const t=document.getElementById("modal-overlay");t.hidden=!0,document.body.style.overflow="",this._onClose&&(this._onClose(),this._onClose=null)},confirm(t,e){this.show({title:"Confirm",body:`<p>${t}</p>`,footer:`
          <button class="btn btn--secondary" onclick="window.TillerApp.Modal.hide()">Cancel</button>
          <button class="btn btn--danger" id="modal-confirm-btn">Delete</button>
        `}),document.getElementById("modal-confirm-btn").addEventListener("click",()=>{this.hide(),e()})}},S={create(t="New Project"){const e={id:"proj_"+Date.now(),name:t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),calculations:{},notes:"",totalArea:0,rooms:[]};return r.projects.unshift(e),T.save(),this.updateCount(),e},update(t,e){const a=r.projects.findIndex(s=>s.id===t);return a!==-1?(r.projects[a]={...r.projects[a],...e,updatedAt:new Date().toISOString()},T.save(),r.projects[a]):null},delete(t){r.projects=r.projects.filter(e=>e.id!==t),T.save(),this.updateCount()},get(t){return r.projects.find(e=>e.id===t)},getRecent(t=5){return r.projects.sort((e,a)=>new Date(a.updatedAt)-new Date(e.updatedAt)).slice(0,t)},updateCount(){const t=r.projects.length;document.getElementById("projects-count").textContent=t>0?t:""},duplicate(t){const e=this.get(t);if(e){const a={...e};return a.id="proj_"+Date.now(),a.name=e.name+" (Copy)",a.createdAt=new Date().toISOString(),a.updatedAt=new Date().toISOString(),r.projects.unshift(a),T.save(),this.updateCount(),g.show("Project duplicated","success"),a}return null},exportToClipboard(t){const e=this.get(t);if(e){const a=this.formatProjectText(e);navigator.clipboard.writeText(a).then(()=>{g.show("Copied to clipboard","success")}).catch(()=>{g.show("Failed to copy","error")})}},formatProjectText(t){let e=`PROJECT: ${t.name}
`;return e+=`Date: ${new Date(t.updatedAt).toLocaleDateString()}
`,e+="=".repeat(40)+`

`,t.calculations&&Object.entries(t.calculations).forEach(([a,s])=>{e+=`${a.toUpperCase()}:
`,Object.entries(s).forEach(([o,i])=>{e+=`  ${o}: ${i}
`}),e+=`
`}),t.notes&&(e+=`NOTES:
${t.notes}
`),e+=`
---
Generated by TillerPro | tillerstead.com/tools/app/`,e}},ne={movement(t){var a;const{calculateMovementJoints:e}=window.TillersteadFormulas;return e({lengthFt:t.length||t.lengthFt,widthFt:t.width||t.widthFt,exposure:t.exposure||"interior",tempSwingF:(a=t.tempSwingF)!=null?a:30,isSunExposed:t.isSunExposed||!1})},deflection(t){const{calculateDeflection:e}=window.TillersteadFormulas;return e({spanFeet:t.spanFeet,joistSpacingInches:t.joistSpacingInches,joistWidthInches:t.joistWidthInches,joistDepthInches:t.joistDepthInches,modulusPsi:t.modulusPsi||16e5,liveLoadPsft:t.liveLoadPsft||40,deadLoadPsft:t.deadLoadPsft||10})},"heated-floor"(t){const{calculateHeatedFloorLoad:e}=window.TillersteadFormulas;return e({areaSqFt:t.areaSqFt||t.area,wattsPerSqFt:t.wattsPerSqFt||12,voltage:t.voltage||120,thermostatMaxAmps:t.thermostatMaxAmps||15})},moisture(t){const{evaluateMoistureReadings:e}=window.TillersteadFormulas;return e({mverLbs:t.mverLbs,rhPercent:t.rhPercent,productLimitMver:t.productLimitMver||5,productLimitRh:t.productLimitRh||75})},"thinset-mix"(t){const{calculateThinsetMix:e}=window.TillersteadFormulas;return e({bagWeightLbs:t.bagWeightLbs||50,waterQuartsPerBagMin:t.waterQuartsPerBagMin||5,waterQuartsPerBagMax:t.waterQuartsPerBagMax||6,batchWeightLbs:t.batchWeightLbs,potLifeMinutes:t.potLifeMinutes||120,yieldCuFtPerBag:t.yieldCuFtPerBag||.45})},sealer(t){const{estimateSealer:e}=window.TillersteadFormulas;return e({areaSqFt:t.areaSqFt||t.area,surface:t.surface||"natural_stone",coats:t.coats||2})},"deck-mud"(t){const{calculateDeckMud:e}=window.TillersteadFormulas;return e({areaSqFt:t.areaSqFt||t.area,runFeet:t.runFeet,minThicknessInches:t.minThicknessInches||1.25,slopeInchesPerFoot:t.slopeInchesPerFoot||.25,bagYieldCuFt:t.bagYieldCuFt||.5})},primer(t){const{estimatePrimer:e}=window.TillersteadFormulas;return e({areaSqFt:t.areaSqFt||t.area,porosity:t.porosity||"porous",doublePrime:t.doublePrime||!1})},sealant(t){const{estimateSealantTubes:e}=window.TillersteadFormulas;return e({linearFeet:t.linearFeet,beadDiameterInches:t.beadDiameterInches||.25,tubeVolumeOz:t.tubeVolumeOz||10.1})},"bath-layout"(t){var a,s,o,i,p,l,h,n,d,m,u,b,c,v,_,y,w,x,A;const{calculateBathLayout:e}=window.TillersteadFormulas;return e({roomLengthFt:t.roomLengthFt,roomWidthFt:t.roomWidthFt,doorWidthIn:(a=t.doorWidthIn)!=null?a:32,doorWall:(s=t.doorWall)!=null?s:"primary",walkwayMinIn:(o=t.walkwayMinIn)!=null?o:30,includeTub:(i=t.includeTub)!=null?i:!0,tubLengthIn:(p=t.tubLengthIn)!=null?p:60,tubWidthIn:(l=t.tubWidthIn)!=null?l:30,tubFrontClearIn:(h=t.tubFrontClearIn)!=null?h:30,includeShower:(n=t.includeShower)!=null?n:!1,showerWidthIn:(d=t.showerWidthIn)!=null?d:36,showerDepthIn:(m=t.showerDepthIn)!=null?m:36,showerFrontClearIn:(u=t.showerFrontClearIn)!=null?u:30,includeToilet:(b=t.includeToilet)!=null?b:!0,toiletSideClearIn:(c=t.toiletSideClearIn)!=null?c:15,toiletDepthIn:(v=t.toiletDepthIn)!=null?v:28,toiletFrontClearIn:(_=t.toiletFrontClearIn)!=null?_:24,includeVanity:(y=t.includeVanity)!=null?y:!0,vanityWidthIn:(w=t.vanityWidthIn)!=null?w:48,vanityDepthIn:(x=t.vanityDepthIn)!=null?x:22,vanityFrontClearIn:(A=t.vanityFrontClearIn)!=null?A:30})},tile(t){const{area:e,tileSize:a,layout:s,waste:o,tilesPerBox:i,sqftPerBox:p,atticStock:l,customWidth:h,customHeight:n}=t;if(!e||e<=0)return null;let d=W.find(w=>w.id===a)||W[8];if(d.isCustom&&h&&n){const w=parseFloat(h),x=parseFloat(n);d={...d,width:w,height:x,isLargeFormat:Math.max(w,x)>=15}}const m=J.find(w=>w.id===s)||J[0],u=o||m.waste,b=e*(1+u/100);let c;if(d.isMosaic&&d.sheetCoverage)c=Math.ceil(b/d.sheetCoverage);else if(d.width>0&&d.height>0){const w=d.width*d.height/144;c=Math.ceil(b/w)}else c=0;let v=0;i>0?v=Math.ceil(c/i):p>0&&(v=Math.ceil(b/p)),l&&v>0&&(v+=Math.max(1,Math.ceil(v*.05)));const _=[],y=[];return d.isMosaic&&_.push("Mosaic sheets (1 sq ft each)"),d.isLargeFormat&&(_.push("Large-format tile (LFT) \u2014 requires 95% mortar coverage"),m.lippageRisk&&y.push(m.lftWarning||"50% offset NOT recommended for LFT per TCNA")),{areaWithWaste:b.toFixed(1),tilesNeeded:c,boxes:v,wastePercent:u,isLargeFormat:d.isLargeFormat||!1,note:_.join(". "),warning:y.join(" ")}},mortar(t){const{area:e,trowel:a,backButter:s,tileSize:o}=t;if(!e||e<=0)return null;const i=V.find(b=>b.id===a)||V[1],p=o?W.find(b=>b.id===o):null,l=(p==null?void 0:p.isLargeFormat)||!1;let h=Math.ceil(e/i.max),n=Math.ceil(e/i.min);const d=s||l;d&&(h=Math.ceil(h*1.2),n=Math.ceil(n*1.3));const m=[],u=[];return m.push(`Coverage: ${i.min}\u2013${i.max} sq ft/bag per CBP TDS-132`),d&&m.push("Includes ~25% extra for back-buttering"),l&&(i.notForLFT?u.push(`${i.name} NOT recommended for LFT\u2014use 3/4" U-notch`):i.forLFT&&m.push("Correct trowel for LFT")),{bagsMin:h,bagsMax:n,coverage:`${i.min}\u2013${i.max} sq ft/bag`,note:m.join(". "),warning:u.join(" ")}},grout(t){const{area:e,tileWidth:a,tileLength:s,tileThickness:o,jointWidth:i,tileSize:p}=t;if(!e||e<=0)return null;let l=parseFloat(a),h=parseFloat(s);if((!l||!h)&&p){const c=W.find(v=>v.id===p);c&&c.width>0&&(l=c.width,h=c.height)}if(!l||!h)return null;const n=parseFloat(i)||.125,d=parseFloat(o)||.375,m=(h+l)/(h*l)*d*n*oe,u=1/m,b=e*m*1.1;return{pounds:Math.ceil(b),bags25lb:Math.ceil(b/25),bags10lb:Math.ceil(b/10),coverage:u.toFixed(1),lbsPerSqFt:m.toFixed(3),note:`Sanded grout with 10% waste. ~${m.toFixed(2)} lbs/sq ft`}},leveling(t){const{area:e,avgDepth:a,maxDepth:s}=t;if(!e||!a)return null;const o=e*(a/12),i=Math.ceil(o/G);let p=i;if(s&&s>a){const l=e*(s/12);p=Math.ceil(l/G)}return{bags:i,bagsMax:p,volume:o.toFixed(2),note:i!==p?`Range: ${i}\u2013${p} bags (50lb)`:`Based on 50lb bags @ ${G} cu ft/bag`}},slope(t){const{drainToWall:e,slopeRatio:a}=t;if(!e)return null;const s=parseFloat(a)||.25,o=parseFloat(e),i=o*s,p=Math.PI*Math.pow(o,2),l=i/12,h=1/3*Math.PI*Math.pow(o,2)*l,n=h*80,d=Math.ceil(n/60);return{riseAtWall:i.toFixed(2),area:p.toFixed(1),deckMudCuFt:h.toFixed(2),bags60lb:d,note:`${s}" per foot slope to drain`}},waterproof(t){const{wallArea:e,floorArea:a,corners:s,pipes:o}=t,i=(e||0)+(a||0);if(i<=0)return null;const p=Math.ceil(i/50),l=(s||0)*2+(o||0)*2;return{membrane:p,bandFeet:l,coats:2,note:"Based on 50 sq ft/gallon, 2 coats"}},labor(t){const{area:e,complexity:a,includePrep:s,includeDemo:o}=t;if(!e||e<=0)return null;const i=a==="complex"?15:a==="moderate"?20:25;let p=e/i;s&&(p*=1.3),o&&(p*=1.5);const l=Math.ceil(p/8);return{hours:Math.ceil(p),days:l,rate:`${i} sq ft/hour`,note:"Estimate only - varies by conditions"}},crown(t){const{perimeter:e,roomLength:a,roomWidth:s,profile:o,stockLength:i,complexity:p,insideCorners:l,outsideCorners:h}=t;let n=parseFloat(e)||0;if(!n&&a&&s&&(n=2*(parseFloat(a)+parseFloat(s))),n<=0)return null;const d=Q.find(A=>A.id===o)||Q[1],m=parseFloat(i)||12,u=E[p]||E.moderate,b=n*(1+u),c=Math.ceil(b/m),v=parseInt(l)||4,_=parseInt(h)||0,y=v+_,w=b*(d.pricePerFt||2),x=[];return x.push(`${d.name} @ ${m}' lengths`),v>0&&x.push(`${v} inside corners (cope or miter)`),_>0&&x.push(`${_} outside corners (miter)`),d.paintGrade&&x.push("Paint grade - prime before install"),{perimeter:n.toFixed(1),linearFt:b.toFixed(1),pieces:c,insideCorners:v,outsideCorners:_,cornerBlocks:y,wastePercent:Math.round(u*100),materialCost:w.toFixed(2),note:x.join(". ")}},baseboard(t){const{perimeter:e,roomLength:a,roomWidth:s,profile:o,stockLength:i,complexity:p,doorOpenings:l,windowOpenings:h,includePanels:n,panelHeight:d,panelWidth:m,panelCount:u}=t;let b=parseFloat(e)||0;if(!b&&a&&s&&(b=2*(parseFloat(a)+parseFloat(s))),b<=0)return null;const c=Y.find(R=>R.id===o)||Y[1],v=parseFloat(i)||12,_=E[p]||E.moderate,y=(parseInt(l)||0)*3,w=Math.max(0,b-y),x=w*(1+_),A=Math.ceil(x/v);let q=0,P=null;if(n&&u>0){const R=parseFloat(d)||24,N=parseFloat(m)||18,B=parseInt(u)||0,z=2*(R+N)/12;q=z*B*(1+E.coffered),P={count:B,framePerPanel:z.toFixed(1),totalFraming:q.toFixed(1)}}const C=x+q,H=Math.ceil(C/v),f=C*(c.pricePerFt||1.1),D=[];return D.push(`${c.name} @ ${v}' lengths`),y>0&&D.push(`${l} door(s) deducted (${y} ft)`),P&&D.push(`${P.count} wainscot panels (${P.totalFraming} ft framing)`),{grossPerimeter:b.toFixed(1),netPerimeter:w.toFixed(1),linearFt:x.toFixed(1),panelFramingFt:q.toFixed(1),totalLinearFt:C.toFixed(1),pieces:A,totalPieces:H,wastePercent:Math.round(_*100),materialCost:f.toFixed(2),panelDetails:P,note:D.join(". ")}},quarter(t){const{perimeter:e,roomLength:a,roomWidth:s,profile:o,stockLength:i,complexity:p,doorOpenings:l,cabinetRuns:h,transitionStrips:n}=t;let d=parseFloat(e)||0;if(!d&&a&&s&&(d=2*(parseFloat(a)+parseFloat(s))),d<=0)return null;const m=K.find(C=>C.id===o)||K[1],u=parseFloat(i)||8,b=E[p]||E.moderate,c=(parseInt(l)||0)*3,v=parseFloat(h)||0,_=(parseInt(n)||0)*3,y=c+v+_,w=Math.max(0,d-y),x=w*(1+b),A=Math.ceil(x/u),q=x*(m.pricePerFt||.55),P=[];if(P.push(`${m.name} @ ${u}' lengths`),m.isShoe&&P.push("Shoe molding - flexible for uneven floors"),y>0){const C=[];c>0&&C.push(`${l} doors`),v>0&&C.push(`${v} ft cabinets`),_>0&&C.push(`${n} transitions`),P.push(`Deducted: ${C.join(", ")} (${y.toFixed(1)} ft)`)}return{grossPerimeter:d.toFixed(1),deductions:y.toFixed(1),netPerimeter:w.toFixed(1),linearFt:x.toFixed(1),pieces:A,wastePercent:Math.round(b*100),materialCost:q.toFixed(2),note:P.join(". ")}}},M={dashboard(){var i,p;const t=document.getElementById("app-content");if(!t)return;const e=S.getRecent(5),a=r.projects.length,s=r.projects.reduce((l,h)=>l+(h.totalArea||0),0),o=Object.entries(te).sort((l,h)=>l[1].order-h[1].order);t.innerHTML=`
        <div class="dashboard">
          <!-- Hero Section -->
          <div class="dashboard__hero">
            <div class="dashboard__hero-content">
              <h2 class="dashboard__hero-title dashboard__welcome-title">Welcome to TillerPro</h2>
              <p class="dashboard__hero-subtitle">Professional tile calculators built by a licensed NJ contractor</p>
              <div class="dashboard__hero-actions">
                <button class="btn btn--primary btn--lg" onclick="window.TillerApp.Router.navigate('calculators')">
                  <span aria-hidden="true">\u{1F9EE}</span> Start Calculating
                </button>
                <button class="btn btn--secondary btn--lg" onclick="window.TillerApp.createNewProject()">
                  <span aria-hidden="true">\u{1F4C1}</span> New Project
                </button>
              </div>
            </div>
            <div class="dashboard__hero-stats">
              <div class="hero-stat">
                <div class="hero-stat__value">${a}</div>
                <div class="hero-stat__label">Projects</div>
              </div>
              <div class="hero-stat">
                <div class="hero-stat__value">${L.filter(l=>l.status==="ready").length}</div>
                <div class="hero-stat__label">Tools</div>
              </div>
              <div class="hero-stat">
                <div class="hero-stat__value">${s>1e3?(s/1e3).toFixed(1)+"k":s}</div>
                <div class="hero-stat__label">Sq Ft</div>
              </div>
            </div>
          </div>

          <!-- Trust Signals Banner -->
          <div class="trust-banner">
            <div class="trust-banner__item">
              <span class="trust-banner__icon">\u{1F3C6}</span>
              <div class="trust-banner__content">
                <span class="trust-banner__label">Licensed Contractor</span>
                <span class="trust-banner__value">${se.license.number}</span>
              </div>
            </div>
            <div class="trust-banner__item">
              <span class="trust-banner__icon">\u{1F4D8}</span>
              <div class="trust-banner__content">
                <span class="trust-banner__label">TCNA 2024</span>
                <span class="trust-banner__value">Compliant</span>
              </div>
            </div>
            <div class="trust-banner__item">
              <span class="trust-banner__icon">\u2705</span>
              <div class="trust-banner__content">
                <span class="trust-banner__label">ANSI Standards</span>
                <span class="trust-banner__value">A108/A118</span>
              </div>
            </div>
            <div class="trust-banner__item">
              <span class="trust-banner__icon">\u{1F6E1}\uFE0F</span>
              <div class="trust-banner__content">
                <span class="trust-banner__label">Insurance</span>
                <span class="trust-banner__value">Fully Covered</span>
              </div>
            </div>
          </div>

          <!-- Quick Actions Grid -->
          <section class="dashboard__section dashboard__section--quick-actions">
            <div class="dashboard__section-header">
              <h3 class="dashboard__section-title">
                <span class="dashboard__section-icon" aria-hidden="true">\u26A1</span>
                Quick Actions
              </h3>
            </div>
            <div class="quick-actions-grid">
              <button class="quick-action-card" onclick="window.TillerApp.Router.navigate('calculators'); window.TillerApp.setActiveCalculator('tile');">
                <span class="quick-action-card__icon">\u{1F9F1}</span>
                <span class="quick-action-card__title">Calculate Tile</span>
                <span class="quick-action-card__desc">Tiles, boxes & waste</span>
              </button>
              <button class="quick-action-card" onclick="window.TillerApp.Router.navigate('calculators'); window.TillerApp.setActiveCalculator('mortar');">
                <span class="quick-action-card__icon">\u{1F527}</span>
                <span class="quick-action-card__title">Mortar Estimate</span>
                <span class="quick-action-card__desc">Thin-set coverage</span>
              </button>
              <button class="quick-action-card" onclick="window.TillerApp.Router.navigate('calculators'); window.TillerApp.setActiveCalculator('grout');">
                <span class="quick-action-card__icon">\u{1FAA3}</span>
                <span class="quick-action-card__title">Grout Calc</span>
                <span class="quick-action-card__desc">Bags & coverage</span>
              </button>
              <button class="quick-action-card quick-action-card--highlight" onclick="window.TillerApp.createNewProject();">
                <span class="quick-action-card__icon">\u{1F4CB}</span>
                <span class="quick-action-card__title">Full Estimate</span>
                <span class="quick-action-card__desc">Complete material list</span>
              </button>
            </div>
          </section>

          <!-- Pro Tip of the Day -->
          <section class="dashboard__section dashboard__section--tip">
            <div class="pro-tip-card">
              <div class="pro-tip-card__header">
                <span class="pro-tip-card__icon">\u{1F4A1}</span>
                <span class="pro-tip-card__label">Pro Tip</span>
              </div>
              <p class="pro-tip-card__text">${((i=U("tile"))==null?void 0:i.tip)||"Always order 10-15% extra tile for waste, cuts, and future repairs."}</p>
              <span class="pro-tip-card__source">Source: ${((p=U("tile"))==null?void 0:p.source)||"Industry Standard"}</span>
            </div>
          </section>

          <!-- Calculator Sections by Category -->
          ${o.map(([l,h])=>{const n=L.filter(d=>d.category===l&&d.status==="ready");return n.length===0?"":`
              <section class="dashboard__section dashboard__section--category" id="dash-cat-${l}">
                <div class="dashboard__section-header">
                  <div class="dashboard__section-header-info">
                    <h3 class="dashboard__section-title">
                      <span class="dashboard__section-icon" aria-hidden="true">${h.icon}</span>
                      ${h.name}
                    </h3>
                    <p class="dashboard__section-desc">${h.longDesc||h.desc}</p>
                  </div>
                  <span class="dashboard__section-badge">${n.length} tools</span>
                </div>
                <div class="calc-grid calc-grid--${l}">
                  ${n.map(d=>`
                    <button class="calc-card" data-calc="${d.id}" title="${d.tooltip||d.desc}">
                      <span class="calc-card__icon" aria-hidden="true">${d.icon}</span>
                      <div class="calc-card__content">
                        <span class="calc-card__name">${d.name}</span>
                        <span class="calc-card__desc">${d.desc}</span>
                      </div>
                      <svg class="calc-card__arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M9 18l6-6-6-6"/></svg>
                    </button>
                  `).join("")}
                </div>
              </section>
            `}).join("")}

          <!-- Coming Soon -->
          ${L.filter(l=>l.status==="coming").length>0?`
          <section class="dashboard__section dashboard__section--muted">
            <div class="dashboard__section-header">
              <h3 class="dashboard__section-title">Coming Soon</h3>
              <span class="dashboard__section-badge dashboard__section-badge--muted">${L.filter(l=>l.status==="coming").length} planned</span>
            </div>
            <div class="calc-grid calc-grid--coming">
              ${L.filter(l=>l.status==="coming").map(l=>`
                <div class="calc-card calc-card--coming" aria-disabled="true">
                  <span class="calc-card__icon" aria-hidden="true">${l.icon}</span>
                  <div class="calc-card__content">
                    <span class="calc-card__name">${l.name}</span>
                    <span class="calc-card__desc">${l.desc}</span>
                  </div>
                  <span class="calc-card__badge">Coming Soon</span>
                </div>
              `).join("")}
            </div>
          </section>
          `:""}

          <!-- Recent Projects -->
          <section class="dashboard__section">
            <div class="dashboard__section-header">
              <h3 class="dashboard__section-title">
                <span class="dashboard__section-icon" aria-hidden="true">\u{1F4CB}</span>
                Recent Projects
              </h3>
              ${e.length>0?'<a href="#/projects" class="dashboard__section-action">View All \u2192</a>':""}
            </div>
            ${e.length>0?`
              <ul class="recent-list">
                ${e.map(l=>`
                  <li class="recent-list__item" data-project-id="${l.id}">
                    <div class="recent-list__icon" aria-hidden="true">\u{1F4CB}</div>
                    <div class="recent-list__content">
                      <div class="recent-list__name">${this.escapeHtml(l.name)}</div>
                      <div class="recent-list__meta">Updated ${this.formatDate(l.updatedAt)}</div>
                    </div>
                    <svg class="recent-list__arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M9 18l6-6-6-6"/></svg>
                  </li>
                `).join("")}
              </ul>
            `:`
              <div class="empty-state">
                <div class="empty-state__icon" aria-hidden="true">\u{1F4CB}</div>
                <h4 class="empty-state__title">No projects yet</h4>
                <p class="empty-state__text">Start calculating to create your first project.</p>
              </div>
            `}
          </section>

          <!-- Why Choose TillerPro -->
          <section class="dashboard__section dashboard__section--features">
            <div class="dashboard__section-header">
              <h3 class="dashboard__section-title">
                <span class="dashboard__section-icon" aria-hidden="true">\u2B50</span>
                Why America Trusts TillerPro
              </h3>
            </div>
            <div class="features-grid">
              <div class="feature-card">
                <span class="feature-card__icon">\u{1F3AF}</span>
                <h4 class="feature-card__title">TCNA Compliant</h4>
                <p class="feature-card__desc">All calculations follow Tile Council of North America 2024 standards.</p>
              </div>
              <div class="feature-card">
                <span class="feature-card__icon">\u{1F477}</span>
                <h4 class="feature-card__title">Built by Pros</h4>
                <p class="feature-card__desc">Developed by licensed NJ contractors with 10+ years field experience.</p>
              </div>
              <div class="feature-card">
                <span class="feature-card__icon">\u{1F4F1}</span>
                <h4 class="feature-card__title">Works Offline</h4>
                <p class="feature-card__desc">Use on the job site\u2014no internet required after first load.</p>
              </div>
              <div class="feature-card">
                <span class="feature-card__icon">\u{1F512}</span>
                <h4 class="feature-card__title">Your Data, Private</h4>
                <p class="feature-card__desc">All projects stored locally on your device. No account required.</p>
              </div>
            </div>
          </section>

          <!-- Contact CTA -->
          <section class="dashboard__section dashboard__section--cta">
            <div class="cta-card">
              <div class="cta-card__content">
                <h3 class="cta-card__title">Need Professional Installation?</h3>
                <p class="cta-card__text">Tillerstead LLC serves South Jersey & Shore communities with expert tile installation. Licensed, insured, TCNA-trained.</p>
              </div>
              <div class="cta-card__actions">
                <a href="tel:${k.COMPANY.phone.replace(/[^0-9]/g,"")}" class="btn btn--primary">
                  <span>\u{1F4DE}</span> ${k.COMPANY.phone}
                </a>
                <a href="/contact/" class="btn btn--secondary">
                  <span>\u{1F4E7}</span> Request Quote
                </a>
              </div>
            </div>
          </section>
        </div>
      `,t.querySelectorAll("[data-project-id]").forEach(l=>{l.addEventListener("click",()=>{r.activeProject=l.dataset.projectId,j.navigate("calculators")})}),t.querySelectorAll(".calc-card").forEach(l=>{l.addEventListener("click",()=>{r.activeCalculator=l.dataset.calc,j.navigate("calculators")})})},calculators(){const t=document.getElementById("app-content");if(!t)return;const e=Object.entries(te).sort((n,d)=>n[1].order-d[1].order),a=L.filter(n=>{if(!r.searchQuery)return!0;const d=r.searchQuery.toLowerCase();return n.name.toLowerCase().includes(d)||n.desc&&n.desc.toLowerCase().includes(d)||n.tooltip&&n.tooltip.toLowerCase().includes(d)}),s=r.activeCalculator;let o=L.find(n=>n.id===s);if(!o){const n=a[0]||L[0];r.activeCalculator=n.id,o=n}t.innerHTML=`
        <!-- Sticky Section Navigation -->
        <div class="calc-sticky-nav" aria-label="Calculator navigation" role="navigation">
          <div class="calc-sticky-nav__wrap">
            <div class="calc-sticky-nav__links">
              ${e.map(([n,d])=>`
                <button class="calc-sticky-nav__link" data-target="calc-cat-${n}" title="${d.longDesc||d.desc}">
                  <span class="calc-sticky-nav__icon">${d.icon}</span>
                  <span class="calc-sticky-nav__label">${d.name}</span>
                </button>
              `).join("")}
            </div>
            <div class="calc-sticky-nav__search">
              <label class="sr-only" for="calc-search-input">Search calculators</label>
              <input id="calc-search-input" class="calc-search__input" type="search" placeholder="Search calculators..." value="${r.searchQuery||""}" aria-describedby="search-hint">
              <span class="calc-search__icon" aria-hidden="true">\u{1F50D}</span>
              <span id="search-hint" class="sr-only">Search by name, description, or function</span>
            </div>
          </div>
        </div>

        <div class="calculators-layout">
          <!-- Calculator Selector Panel -->
          <aside class="calc-selector" aria-label="Calculator list">
            <div class="calc-selector__header">
              <h2 class="calc-selector__title">Calculators</h2>
              <p class="calc-selector__subtitle">${L.filter(n=>n.status==="ready").length} tools \u2022 Grouped by workflow</p>
            </div>
            <nav class="calc-selector__list" role="tablist" aria-label="Calculator selection">
              ${e.map(([n,d])=>{const m=a.filter(u=>u.category===n);return m.length===0?"":`
                  <div class="calc-selector__group" id="calc-cat-${n}">
                    <button class="calc-selector__group-header" aria-expanded="true" data-collapse="${n}">
                      <div class="calc-selector__group-info">
                        <span class="calc-selector__group-title">${d.icon} ${d.name}</span>
                        <span class="calc-selector__group-desc">${d.desc}</span>
                      </div>
                      <span class="calc-selector__group-count">${m.length}</span>
                      <svg class="calc-selector__chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M6 9l6 6 6-6"/></svg>
                    </button>
                    <div class="calc-selector__group-items" data-group="${n}">
                      ${m.map(u=>`
                        <button class="calc-selector__item ${u.id===s?"is-active":""} ${u.status==="coming"?"is-coming":""}" 
                                role="tab" 
                                aria-selected="${u.id===s}"
                                ${u.status==="coming"?'disabled aria-disabled="true"':""}
                                data-calc="${u.id}"
                                title="${u.tooltip||u.desc}">
                          <span class="calc-selector__icon">${u.icon}</span>
                          <div class="calc-selector__info">
                            <span class="calc-selector__name">${u.name}</span>
                            ${u.status==="coming"?'<span class="calc-selector__badge">Soon</span>':`<span class="calc-selector__desc">${u.desc}</span>`}
                          </div>
                          ${u.status==="ready"?'<svg class="calc-selector__arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M9 18l6-6-6-6"/></svg>':""}
                        </button>
                      `).join("")}
                    </div>
                  </div>
                `}).join("")}
            </nav>
          </aside>

          <!-- Active Calculator Panel -->
          <main class="calc-workspace" id="calc-workspace">
            <div class="calc-panel is-active" id="calc-panel-${s}" role="tabpanel" aria-labelledby="calc-panel-title">
              <div class="calc-panel__header">
                <div class="calc-panel__badge" aria-hidden="true">${o.icon}</div>
                <div class="calc-panel__header-content">
                  <h2 class="calc-panel__title" id="calc-panel-title">${o.name}</h2>
                  <p class="calc-panel__desc">${o.desc}</p>
                </div>
                ${o.tooltip?`
                  <button class="calc-panel__help" type="button" aria-label="Show help" title="More information">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                      <circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/>
                    </svg>
                  </button>
                `:""}
              </div>
              ${o.tooltip?`
                <div class="calc-panel__tooltip" role="note" aria-label="Calculator guidance" hidden>
                  <div class="calc-panel__tooltip-content">
                    <strong>\u{1F4A1} Tip:</strong> ${o.tooltip}
                  </div>
                  <button class="calc-panel__tooltip-close" type="button" aria-label="Close tip">\xD7</button>
                </div>
              `:""}
              <div class="calc-panel__body">
                ${this.renderCalculatorForm(s)}
              </div>
            </div>
          </main>
        </div>

        <!-- Mobile Calculator Dropdown (shown only on small screens) -->
        <div class="calc-mobile-select" aria-label="Mobile calculator selection">
          <label class="form-label" for="calc-mobile-dropdown">Select Calculator</label>
          <select class="form-select calc-mobile-dropdown" id="calc-mobile-dropdown" aria-label="Select calculator">
            ${e.map(([n,d])=>{const m=a.filter(u=>u.category===n&&u.status==="ready");return m.length===0?"":`
                <optgroup label="${d.icon} ${d.name}">
                  ${m.map(u=>`
                    <option value="${u.id}" ${u.id===s?"selected":""}>${u.name}</option>
                  `).join("")}
                </optgroup>
              `}).join("")}
          </select>
        </div>
      `,t.querySelectorAll(".calc-selector__item").forEach(n=>{n.addEventListener("click",()=>{r.activeCalculator=n.dataset.calc,this.calculators();const d=document.getElementById("calc-workspace");d&&window.innerWidth<900&&d.scrollIntoView({behavior:"smooth",block:"start"})})}),t.querySelectorAll(".calc-selector__group-header[data-collapse]").forEach(n=>{n.addEventListener("click",()=>{const d=n.dataset.collapse,m=t.querySelector(`.calc-selector__group-items[data-group="${d}"]`),u=n.getAttribute("aria-expanded")==="true";n.setAttribute("aria-expanded",!u),m&&m.classList.toggle("is-collapsed",u)})});const i=t.querySelector(".calc-panel__help"),p=t.querySelector(".calc-panel__tooltip");if(i&&p){i.addEventListener("click",()=>{p.hidden=!p.hidden});const n=p.querySelector(".calc-panel__tooltip-close");n&&n.addEventListener("click",()=>{p.hidden=!0})}const l=t.querySelector("#calc-search-input");if(l){let n;l.addEventListener("input",d=>{clearTimeout(n),n=setTimeout(()=>{r.searchQuery=d.target.value;const m=L.filter(b=>{if(!r.searchQuery)return!0;const c=r.searchQuery.toLowerCase();return b.name.toLowerCase().includes(c)||b.desc&&b.desc.toLowerCase().includes(c)||b.tooltip&&b.tooltip.toLowerCase().includes(c)});!m.some(b=>b.id===r.activeCalculator)&&m.length>0&&(r.activeCalculator=m[0].id),this.calculators();const u=document.getElementById("calc-search-input");u&&(u.focus(),u.setSelectionRange(u.value.length,u.value.length))},200)})}t.querySelectorAll(".calc-sticky-nav__link").forEach(n=>{n.addEventListener("click",()=>{const d=n.dataset.target,m=document.getElementById(d);m&&m.scrollIntoView({behavior:"smooth",block:"start"})})});const h=t.querySelector(".calc-mobile-dropdown");h&&h.addEventListener("change",n=>{r.activeCalculator=n.target.value,this.calculators()}),this.attachCalculatorListeners(),ae(t)},renderCalculatorForm(t){var l,h,n,d,m,u,b,c,v,_,y,w,x,A,q,P,C,H;const e=r.calculatorInputs[t]||{},a=r.calculatorResults[t],s=({title:f="Sq Ft Helper (W\xD7L\xD7H)",targetFloorName:D,targetWallName:R,includeHeight:N=!0,note:B})=>{const z=D?` data-target-floor="${D}"`:"",pe=R?` data-target-wall="${R}"`:"";return`
          <div class="form-section sqft-helper" data-sqft-helper${z}${pe}>
            <div class="form-section__title">${f}</div>
            <div class="form-grid form-grid--3col">
              <div class="form-field">
                <label class="form-label">Width</label>
                <div class="input-group">
                  <input type="number" class="form-input" inputmode="decimal" data-sqft="width" min="0" step="0.1" placeholder="e.g. 8">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Length</label>
                <div class="input-group">
                  <input type="number" class="form-input" inputmode="decimal" data-sqft="length" min="0" step="0.1" placeholder="e.g. 10">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
              ${N?`
              <div class="form-field">
                <label class="form-label">Height</label>
                <div class="input-group">
                  <input type="number" class="form-input" inputmode="decimal" data-sqft="height" min="0" step="0.1" placeholder="e.g. 8">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
              `:""}
            </div>

            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label">Floor Area</label>
                <div class="input-group">
                  <input type="text" class="form-input" data-sqft-output="floor" value="\u2014" readonly>
                  <span class="input-group__suffix">sq ft</span>
                </div>
                <p class="form-help">\u2248 width \xD7 length</p>
              </div>
              ${N?`
              <div class="form-field">
                <label class="form-label">Wall Area (4 walls)</label>
                <div class="input-group">
                  <input type="text" class="form-input" data-sqft-output="walls" value="\u2014" readonly>
                  <span class="input-group__suffix">sq ft</span>
                </div>
                <p class="form-help">\u2248 2 \xD7 height \xD7 (width + length)</p>
              </div>
              `:""}
            </div>

            <div class="mt-lg" style="display:flex; gap: .75rem; flex-wrap: wrap;">
              ${D?'<button type="button" class="btn btn--secondary btn--sm" data-sqft-action="use-floor">Use floor area</button>':""}
              ${R&&N?'<button type="button" class="btn btn--secondary btn--sm" data-sqft-action="use-walls">Use wall area</button>':""}
            </div>
            ${B?`<p class="form-help mt-sm">${B}</p>`:""}
          </div>
        `},o={tile:`
          <div class="form-grid form-grid--2col">
            <div class="form-field">
              <label class="form-label form-label--required">Room Area</label>
              <div class="input-group">
                <input type="number" class="form-input" name="area" value="${e.area||""}" min="1" step="0.1" placeholder="e.g. 120">
                <span class="input-group__suffix">sq ft</span>
              </div>
              <p class="form-help">Length \xD7 Width of the space</p>
            </div>
            <div class="form-field">
              <label class="form-label">Tile Size</label>
              <select class="form-select" name="tileSize">
                ${W.map(f=>`<option value="${f.id}" ${e.tileSize===f.id?"selected":""}>${f.name}</option>`).join("")}
              </select>
            </div>
            <div class="form-field">
              <label class="form-label">Layout Pattern</label>
              <select class="form-select" name="layout">
                ${J.map(f=>`<option value="${f.id}" ${e.layout===f.id?"selected":""}>${f.name} (+${f.waste}% waste)</option>`).join("")}
              </select>
              <p class="form-help">Pattern affects waste factor</p>
            </div>
            <div class="form-field">
              <label class="form-label">Waste Factor</label>
              <div class="input-group">
                <input type="number" class="form-input" name="waste" value="${e.waste||""}" min="5" max="40" placeholder="Auto">
                <span class="input-group__suffix">%</span>
              </div>
              <p class="form-help">Leave empty for auto based on layout</p>
            </div>
          </div>
          ${s({title:"Sq Ft Helper (Room)",targetFloorName:"area",includeHeight:!1})}
          <div class="form-section">
            <div class="form-section__title">Box Packaging (Optional)</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label">Tiles per Box</label>
                <input type="number" class="form-input" name="tilesPerBox" value="${e.tilesPerBox||""}" min="1" placeholder="From box label">
              </div>
              <div class="form-field">
                <label class="form-label">Sq Ft per Box</label>
                <input type="number" class="form-input" name="sqftPerBox" value="${e.sqftPerBox||""}" min="0.1" step="0.1" placeholder="From box label">
              </div>
            </div>
          </div>
          <div class="form-field mt-lg">
            <label class="form-checkbox">
              <input type="checkbox" name="atticStock" ${e.atticStock?"checked":""}>
              <span>Add attic stock (+5% or 1 box minimum for future repairs)</span>
            </label>
          </div>
        `,mortar:`
          <div class="form-grid form-grid--2col">
            <div class="form-field">
              <label class="form-label form-label--required">Tile Area</label>
              <div class="input-group">
                <input type="number" class="form-input" name="area" value="${e.area||""}" min="1" step="0.1" placeholder="e.g. 120">
                <span class="input-group__suffix">sq ft</span>
              </div>
            </div>
            <div class="form-field">
              <label class="form-label">Trowel Size</label>
              <select class="form-select" name="trowel">
                ${V.map(f=>`<option value="${f.id}" ${e.trowel===f.id?"selected":""}>${f.name}</option>`).join("")}
              </select>
              <p class="form-help">Larger tiles = larger trowel</p>
            </div>
          </div>
          ${s({title:"Sq Ft Helper (Tile Area)",targetFloorName:"area",includeHeight:!1})}
          <div class="form-field mt-lg">
            <label class="form-checkbox">
              <input type="checkbox" name="backButter" ${e.backButter?"checked":""}>
              <span>Include back-buttering (large format tiles, +25% mortar)</span>
            </label>
          </div>
        `,grout:`
          <div class="form-grid form-grid--2col">
            <div class="form-field">
              <label class="form-label form-label--required">Tile Area</label>
              <div class="input-group">
                <input type="number" class="form-input" name="area" value="${e.area||""}" min="1" step="0.1" placeholder="e.g. 120">
                <span class="input-group__suffix">sq ft</span>
              </div>
            </div>
            <div class="form-field">
              <label class="form-label">Joint Width</label>
              <div class="input-group">
                <input type="number" class="form-input" name="jointWidth" value="${e.jointWidth||.125}" min="0.0625" max="0.5" step="0.0625">
                <span class="input-group__suffix">in</span>
              </div>
              <p class="form-help">1/16" = 0.0625, 1/8" = 0.125</p>
            </div>
          </div>
          ${s({title:"Sq Ft Helper (Tile Area)",targetFloorName:"area",includeHeight:!1})}
          <div class="form-section">
            <div class="form-section__title">Tile Dimensions</div>
            <div class="form-grid form-grid--3col">
              <div class="form-field">
                <label class="form-label">Width</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="tileWidth" value="${e.tileWidth||12}" min="1" step="0.25">
                  <span class="input-group__suffix">in</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Length</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="tileLength" value="${e.tileLength||12}" min="1" step="0.25">
                  <span class="input-group__suffix">in</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Thickness</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="tileThickness" value="${e.tileThickness||.375}" min="0.125" max="0.75" step="0.125">
                  <span class="input-group__suffix">in</span>
                </div>
                <p class="form-help">Joint depth</p>
              </div>
            </div>
          </div>
        `,leveling:`
          <div class="form-grid form-grid--2col">
            <div class="form-field">
              <label class="form-label form-label--required">Floor Area</label>
              <div class="input-group">
                <input type="number" class="form-input" name="area" value="${e.area||""}" min="1" step="0.1" placeholder="e.g. 120">
                <span class="input-group__suffix">sq ft</span>
              </div>
            </div>
            <div class="form-field">
              <label class="form-label form-label--required">Average Depth</label>
              <div class="input-group">
                <input type="number" class="form-input" name="avgDepth" value="${e.avgDepth||""}" min="0.125" max="3" step="0.125" placeholder="e.g. 0.25">
                <span class="input-group__suffix">in</span>
              </div>
              <p class="form-help">Typical: 1/8" to 1/2"</p>
            </div>
            <div class="form-field">
              <label class="form-label">Maximum Depth</label>
              <div class="input-group">
                <input type="number" class="form-input" name="maxDepth" value="${e.maxDepth||""}" min="0.125" max="3" step="0.125" placeholder="Optional">
                <span class="input-group__suffix">in</span>
              </div>
              <p class="form-help">Deepest pour point</p>
            </div>
          </div>
          ${s({title:"Sq Ft Helper (Floor)",targetFloorName:"area",includeHeight:!1})}
        `,slope:`
          <div class="form-grid form-grid--2col">
            <div class="form-field">
              <label class="form-label form-label--required">Drain to Wall</label>
              <div class="input-group">
                <input type="number" class="form-input" name="drainToWall" value="${e.drainToWall||""}" min="1" max="10" step="0.25" placeholder="e.g. 3">
                <span class="input-group__suffix">ft</span>
              </div>
              <p class="form-help">Distance from center drain to wall</p>
            </div>
            <div class="form-field">
              <label class="form-label">Slope Ratio</label>
              <div class="input-group">
                <input type="number" class="form-input" name="slopeRatio" value="${e.slopeRatio||.25}" min="0.125" max="0.5" step="0.125">
                <span class="input-group__suffix">"/ft</span>
              </div>
              <p class="form-help">Standard: 1/4" per foot</p>
            </div>
          </div>
        `,waterproof:`
          <div class="form-grid form-grid--2col">
            <div class="form-field">
              <label class="form-label form-label--required">Wall Area</label>
              <div class="input-group">
                <input type="number" class="form-input" name="wallArea" value="${e.wallArea||""}" min="0" step="0.1" placeholder="e.g. 80">
                <span class="input-group__suffix">sq ft</span>
              </div>
              <p class="form-help">Total wall surface in wet areas</p>
            </div>
            <div class="form-field">
              <label class="form-label">Floor Area</label>
              <div class="input-group">
                <input type="number" class="form-input" name="floorArea" value="${e.floorArea||""}" min="0" step="0.1" placeholder="e.g. 25">
                <span class="input-group__suffix">sq ft</span>
              </div>
              <p class="form-help">Shower floor, curb, bench tops</p>
            </div>
            <div class="form-field">
              <label class="form-label">Inside Corners</label>
              <input type="number" class="form-input" name="corners" value="${e.corners||4}" min="0" max="50" placeholder="e.g. 4">
              <p class="form-help">Count all inside corners</p>
            </div>
            <div class="form-field">
              <label class="form-label">Pipe Penetrations</label>
              <input type="number" class="form-input" name="pipes" value="${e.pipes||1}" min="0" max="20" placeholder="e.g. 2">
              <p class="form-help">Shower head, valve, etc.</p>
            </div>
          </div>
          ${s({title:"Sq Ft Helper (Room)",targetWallName:"wallArea",targetFloorName:"floorArea",includeHeight:!0,note:"This estimates full-room wall area (4 walls). For a shower, adjust wall area for 3 walls and subtract openings."})}
        `,labor:`
          <div class="form-grid form-grid--2col">
            <div class="form-field">
              <label class="form-label form-label--required">Total Area</label>
              <div class="input-group">
                <input type="number" class="form-input" name="area" value="${e.area||""}" min="1" step="0.1" placeholder="e.g. 120">
                <span class="input-group__suffix">sq ft</span>
              </div>
            </div>
            <div class="form-field">
              <label class="form-label">Job Complexity</label>
              <select class="form-select" name="complexity">
                <option value="simple" ${e.complexity==="simple"?"selected":""}>Simple \u2013 Straight lay, minimal cuts</option>
                <option value="moderate" ${e.complexity==="moderate"?"selected":""}>Moderate \u2013 Pattern work, some cuts</option>
                <option value="complex" ${e.complexity==="complex"?"selected":""}>Complex \u2013 Mosaics, intricate patterns</option>
              </select>
            </div>
          </div>
          ${s({title:"Sq Ft Helper (Area)",targetFloorName:"area",includeHeight:!1})}
          <div class="form-section">
            <div class="form-section__title">Additional Work</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-checkbox">
                  <input type="checkbox" name="includePrep" ${e.includePrep?"checked":""}>
                  <span>Include surface prep (+30% time)</span>
                </label>
              </div>
              <div class="form-field">
                <label class="form-checkbox">
                  <input type="checkbox" name="includeDemo" ${e.includeDemo?"checked":""}>
                  <span>Include demo of existing (+50% time)</span>
                </label>
              </div>
            </div>
          </div>
        `,"bath-layout":`
          <div class="form-section">
            <div class="form-section__title">Room</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label form-label--required">Room Length</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="roomLengthFt" value="${e.roomLengthFt||""}" min="4" step="0.5" placeholder="e.g. 10">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label form-label--required">Room Width</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="roomWidthFt" value="${e.roomWidthFt||""}" min="4" step="0.5" placeholder="e.g. 5">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Door Width</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="doorWidthIn" value="${(l=e.doorWidthIn)!=null?l:32}" min="24" max="42" step="1">
                  <span class="input-group__suffix">in</span>
                </div>
                <p class="form-help">Only deducted if door is on the selected wall</p>
              </div>
              <div class="form-field">
                <label class="form-label">Door Wall</label>
                <select class="form-select" name="doorWall">
                  <option value="primary" ${!e.doorWall||e.doorWall==="primary"?"selected":""}>Primary wall (legacy default)</option>
                  <option value="length" ${e.doorWall==="length"?"selected":""}>Length wall</option>
                  <option value="width" ${e.doorWall==="width"?"selected":""}>Width wall</option>
                  <option value="none" ${e.doorWall==="none"?"selected":""}>Not on fixture wall</option>
                </select>
                <p class="form-help">Which wall loses usable length due to the door opening</p>
              </div>
              <div class="form-field">
                <label class="form-label">Walkway Minimum</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="walkwayMinIn" value="${(h=e.walkwayMinIn)!=null?h:30}" min="24" max="42" step="1">
                  <span class="input-group__suffix">in</span>
                </div>
                <p class="form-help">30\u201336" recommended clear path</p>
              </div>
            </div>
          </div>

          <div class="form-section">
            <div class="form-section__title">Fixtures</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-checkbox">
                  <input type="checkbox" name="includeTub" ${(n=e.includeTub)==null||n?"checked":""}>
                  <span>Include Tub</span>
                </label>
                <div class="form-grid form-grid--2col mt-sm">
                  <div class="form-field">
                    <label class="form-label">Tub Length</label>
                    <div class="input-group">
                      <input type="number" class="form-input" name="tubLengthIn" value="${(d=e.tubLengthIn)!=null?d:60}" min="54" max="72" step="1">
                      <span class="input-group__suffix">in</span>
                    </div>
                  </div>
                  <div class="form-field">
                    <label class="form-label">Tub Width</label>
                    <div class="input-group">
                      <input type="number" class="form-input" name="tubWidthIn" value="${(m=e.tubWidthIn)!=null?m:30}" min="28" max="36" step="1">
                      <span class="input-group__suffix">in</span>
                    </div>
                  </div>
                  <div class="form-field">
                    <label class="form-label">Front Clearance</label>
                    <div class="input-group">
                      <input type="number" class="form-input" name="tubFrontClearIn" value="${(u=e.tubFrontClearIn)!=null?u:30}" min="24" max="42" step="1">
                      <span class="input-group__suffix">in</span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-field">
                <label class="form-checkbox">
                  <input type="checkbox" name="includeShower" ${(b=e.includeShower)!=null&&b?"checked":""}>
                  <span>Include Shower</span>
                </label>
                <div class="form-grid form-grid--2col mt-sm">
                  <div class="form-field">
                    <label class="form-label">Shower Width</label>
                    <div class="input-group">
                      <input type="number" class="form-input" name="showerWidthIn" value="${(c=e.showerWidthIn)!=null?c:36}" min="30" max="60" step="1">
                      <span class="input-group__suffix">in</span>
                    </div>
                  </div>
                  <div class="form-field">
                    <label class="form-label">Shower Depth</label>
                    <div class="input-group">
                      <input type="number" class="form-input" name="showerDepthIn" value="${(v=e.showerDepthIn)!=null?v:36}" min="30" max="60" step="1">
                      <span class="input-group__suffix">in</span>
                    </div>
                  </div>
                  <div class="form-field">
                    <label class="form-label">Front Clearance</label>
                    <div class="input-group">
                      <input type="number" class="form-input" name="showerFrontClearIn" value="${(_=e.showerFrontClearIn)!=null?_:30}" min="24" max="42" step="1">
                      <span class="input-group__suffix">in</span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-field">
                <label class="form-checkbox">
                  <input type="checkbox" name="includeToilet" ${(y=e.includeToilet)==null||y?"checked":""}>
                  <span>Include Toilet</span>
                </label>
                <div class="form-grid form-grid--2col mt-sm">
                  <div class="form-field">
                    <label class="form-label">Side Clearance</label>
                    <div class="input-group">
                      <input type="number" class="form-input" name="toiletSideClearIn" value="${(w=e.toiletSideClearIn)!=null?w:15}" min="12" max="18" step="1">
                      <span class="input-group__suffix">in</span>
                    </div>
                  </div>
                  <div class="form-field">
                    <label class="form-label">Toilet Depth</label>
                    <div class="input-group">
                      <input type="number" class="form-input" name="toiletDepthIn" value="${(x=e.toiletDepthIn)!=null?x:28}" min="26" max="32" step="1">
                      <span class="input-group__suffix">in</span>
                    </div>
                  </div>
                  <div class="form-field">
                    <label class="form-label">Front Clearance</label>
                    <div class="input-group">
                      <input type="number" class="form-input" name="toiletFrontClearIn" value="${(A=e.toiletFrontClearIn)!=null?A:24}" min="21" max="36" step="1">
                      <span class="input-group__suffix">in</span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-field">
                <label class="form-checkbox">
                  <input type="checkbox" name="includeVanity" ${(q=e.includeVanity)==null||q?"checked":""}>
                  <span>Include Vanity</span>
                </label>
                <div class="form-grid form-grid--2col mt-sm">
                  <div class="form-field">
                    <label class="form-label">Vanity Width</label>
                    <div class="input-group">
                      <input type="number" class="form-input" name="vanityWidthIn" value="${(P=e.vanityWidthIn)!=null?P:48}" min="24" max="72" step="1">
                      <span class="input-group__suffix">in</span>
                    </div>
                  </div>
                  <div class="form-field">
                    <label class="form-label">Vanity Depth</label>
                    <div class="input-group">
                      <input type="number" class="form-input" name="vanityDepthIn" value="${(C=e.vanityDepthIn)!=null?C:22}" min="18" max="26" step="1">
                      <span class="input-group__suffix">in</span>
                    </div>
                  </div>
                  <div class="form-field">
                    <label class="form-label">Front Clearance</label>
                    <div class="input-group">
                      <input type="number" class="form-input" name="vanityFrontClearIn" value="${(H=e.vanityFrontClearIn)!=null?H:30}" min="24" max="42" step="1">
                      <span class="input-group__suffix">in</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        `,crown:`
          <div class="form-section">
            <div class="form-section__title">Room Dimensions</div>
            <p class="form-help mb-md">Enter perimeter directly OR room length \xD7 width</p>
            <div class="form-grid form-grid--3col">
              <div class="form-field">
                <label class="form-label">Ceiling Perimeter</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="perimeter" value="${e.perimeter||""}" min="1" step="0.5" placeholder="Direct entry">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Room Length</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="roomLength" value="${e.roomLength||""}" min="1" step="0.5" placeholder="e.g. 15">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Room Width</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="roomWidth" value="${e.roomWidth||""}" min="1" step="0.5" placeholder="e.g. 12">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
            </div>
          </div>
          <div class="form-grid form-grid--2col">
            <div class="form-field">
              <label class="form-label">Crown Profile</label>
              <select class="form-select" name="profile">
                ${Q.map(f=>`<option value="${f.id}" ${e.profile===f.id?"selected":""}>${f.name}${f.pricePerFt?" (~$"+f.pricePerFt+"/ft)":""}</option>`).join("")}
              </select>
            </div>
            <div class="form-field">
              <label class="form-label">Stock Length</label>
              <select class="form-select" name="stockLength">
                ${X.map(f=>`<option value="${f.length}" ${e.stockLength==f.length?"selected":""}>${f.name}</option>`).join("")}
              </select>
            </div>
            <div class="form-field">
              <label class="form-label">Job Complexity</label>
              <select class="form-select" name="complexity">
                <option value="simple" ${e.complexity==="simple"?"selected":""}>Simple \u2013 Few corners (+10% waste)</option>
                <option value="moderate" ${e.complexity==="moderate"||!e.complexity?"selected":""}>Standard Room (+15% waste)</option>
                <option value="complex" ${e.complexity==="complex"?"selected":""}>Complex \u2013 Many angles (+20% waste)</option>
                <option value="coffered" ${e.complexity==="coffered"?"selected":""}>Coffered Ceiling (+25% waste)</option>
              </select>
            </div>
          </div>
          <div class="form-section">
            <div class="form-section__title">Corners</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label">Inside Corners</label>
                <input type="number" class="form-input" name="insideCorners" value="${e.insideCorners||4}" min="0" max="50">
                <p class="form-help">Standard room = 4</p>
              </div>
              <div class="form-field">
                <label class="form-label">Outside Corners</label>
                <input type="number" class="form-input" name="outsideCorners" value="${e.outsideCorners||0}" min="0" max="50">
                <p class="form-help">Soffits, bump-outs, etc.</p>
              </div>
            </div>
          </div>
        `,baseboard:`
          <div class="form-section">
            <div class="form-section__title">Room Dimensions</div>
            <p class="form-help mb-md">Enter perimeter directly OR room length \xD7 width</p>
            <div class="form-grid form-grid--3col">
              <div class="form-field">
                <label class="form-label">Wall Perimeter</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="perimeter" value="${e.perimeter||""}" min="1" step="0.5" placeholder="Direct entry">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Room Length</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="roomLength" value="${e.roomLength||""}" min="1" step="0.5" placeholder="e.g. 15">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Room Width</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="roomWidth" value="${e.roomWidth||""}" min="1" step="0.5" placeholder="e.g. 12">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
            </div>
          </div>
          <div class="form-grid form-grid--2col">
            <div class="form-field">
              <label class="form-label">Profile Type</label>
              <select class="form-select" name="profile">
                ${Y.map(f=>`<option value="${f.id}" ${e.profile===f.id?"selected":""}>${f.name}${f.pricePerFt?" (~$"+f.pricePerFt+"/ft)":""}</option>`).join("")}
              </select>
            </div>
            <div class="form-field">
              <label class="form-label">Stock Length</label>
              <select class="form-select" name="stockLength">
                ${X.map(f=>`<option value="${f.length}" ${e.stockLength==f.length?"selected":""}>${f.name}</option>`).join("")}
              </select>
            </div>
            <div class="form-field">
              <label class="form-label">Job Complexity</label>
              <select class="form-select" name="complexity">
                <option value="simple" ${e.complexity==="simple"?"selected":""}>Simple (+10% waste)</option>
                <option value="moderate" ${e.complexity==="moderate"||!e.complexity?"selected":""}>Standard (+15% waste)</option>
                <option value="complex" ${e.complexity==="complex"?"selected":""}>Complex (+20% waste)</option>
              </select>
            </div>
            <div class="form-field">
              <label class="form-label">Door Openings</label>
              <input type="number" class="form-input" name="doorOpenings" value="${e.doorOpenings||0}" min="0" max="20">
              <p class="form-help">Deducts 3 ft per door</p>
            </div>
          </div>
          <div class="form-section">
            <div class="form-section__title">Wainscoting Panels (Optional)</div>
            <div class="form-field">
              <label class="form-checkbox">
                <input type="checkbox" name="includePanels" ${e.includePanels?"checked":""}>
                <span>Include panel framing calculation</span>
              </label>
            </div>
            <div class="form-grid form-grid--3col mt-md">
              <div class="form-field">
                <label class="form-label">Panel Height</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="panelHeight" value="${e.panelHeight||24}" min="6" max="48" ${e.includePanels?"":"disabled"}>
                  <span class="input-group__suffix">in</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Panel Width</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="panelWidth" value="${e.panelWidth||18}" min="6" max="48" ${e.includePanels?"":"disabled"}>
                  <span class="input-group__suffix">in</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Number of Panels</label>
                <input type="number" class="form-input" name="panelCount" value="${e.panelCount||0}" min="0" max="100" ${e.includePanels?"":"disabled"}>
              </div>
            </div>
          </div>
        `,quarter:`
          <div class="form-section">
            <div class="form-section__title">Room Dimensions</div>
            <p class="form-help mb-md">Enter perimeter directly OR room length \xD7 width</p>
            <div class="form-grid form-grid--3col">
              <div class="form-field">
                <label class="form-label">Floor Perimeter</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="perimeter" value="${e.perimeter||""}" min="1" step="0.5" placeholder="Direct entry">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Room Length</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="roomLength" value="${e.roomLength||""}" min="1" step="0.5" placeholder="e.g. 15">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Room Width</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="roomWidth" value="${e.roomWidth||""}" min="1" step="0.5" placeholder="e.g. 12">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
            </div>
          </div>
          <div class="form-grid form-grid--2col">
            <div class="form-field">
              <label class="form-label">Profile Type</label>
              <select class="form-select" name="profile">
                ${K.map(f=>`<option value="${f.id}" ${e.profile===f.id?"selected":""}>${f.name}${f.pricePerFt?" (~$"+f.pricePerFt+"/ft)":""}</option>`).join("")}
              </select>
            </div>
            <div class="form-field">
              <label class="form-label">Stock Length</label>
              <select class="form-select" name="stockLength">
                <option value="8" ${e.stockLength==8||!e.stockLength?"selected":""}>8 ft (standard)</option>
                ${X.filter(f=>f.length!==8).map(f=>`<option value="${f.length}" ${e.stockLength==f.length?"selected":""}>${f.name}</option>`).join("")}
              </select>
            </div>
            <div class="form-field">
              <label class="form-label">Job Complexity</label>
              <select class="form-select" name="complexity">
                <option value="simple" ${e.complexity==="simple"?"selected":""}>Simple (+10% waste)</option>
                <option value="moderate" ${e.complexity==="moderate"||!e.complexity?"selected":""}>Standard (+15% waste)</option>
                <option value="complex" ${e.complexity==="complex"?"selected":""}>Complex (+20% waste)</option>
              </select>
            </div>
          </div>
          <div class="form-section">
            <div class="form-section__title">Deductions</div>
            <div class="form-grid form-grid--3col">
              <div class="form-field">
                <label class="form-label">Door Openings</label>
                <input type="number" class="form-input" name="doorOpenings" value="${e.doorOpenings||0}" min="0" max="20">
                <p class="form-help">-3 ft each</p>
              </div>
              <div class="form-field">
                <label class="form-label">Cabinet Runs</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="cabinetRuns" value="${e.cabinetRuns||0}" min="0" step="0.5">
                  <span class="input-group__suffix">ft</span>
                </div>
                <p class="form-help">Base cabinets, etc.</p>
              </div>
              <div class="form-field">
                <label class="form-label">Transitions</label>
                <input type="number" class="form-input" name="transitionStrips" value="${e.transitionStrips||0}" min="0" max="20">
                <p class="form-help">T-molds, thresholds</p>
              </div>
            </div>
          </div>
        `,deflection:`
          <div class="form-section">
            <div class="form-section__title">Joist Specifications</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label form-label--required">Joist Span</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="spanFeet" value="${e.spanFeet||""}" min="1" max="30" step="0.5" placeholder="e.g. 12">
                  <span class="input-group__suffix">ft</span>
                </div>
                <p class="form-help">Clear span between supports</p>
              </div>
              <div class="form-field">
                <label class="form-label form-label--required">Joist Spacing</label>
                <select class="form-select" name="joistSpacingInches">
                  <option value="12" ${e.joistSpacingInches==12?"selected":""}>12" O.C.</option>
                  <option value="16" ${e.joistSpacingInches==16||!e.joistSpacingInches?"selected":""}>16" O.C. (typical)</option>
                  <option value="19.2" ${e.joistSpacingInches==19.2?"selected":""}>19.2" O.C.</option>
                  <option value="24" ${e.joistSpacingInches==24?"selected":""}>24" O.C.</option>
                </select>
              </div>
            </div>
            <div class="form-grid form-grid--3col">
              <div class="form-field">
                <label class="form-label form-label--required">Joist Size</label>
                <select class="form-select" name="joistSize" onchange="
                  const sizes = {'2x6':[1.5,5.5],'2x8':[1.5,7.25],'2x10':[1.5,9.25],'2x12':[1.5,11.25],'lvl-9.5':[1.75,9.5],'lvl-11.875':[1.75,11.875],'i-joist-9.5':[1.75,9.5],'i-joist-11.875':[1.75,11.875]};
                  const s = sizes[this.value];
                  if(s){document.querySelector('[name=joistWidthInches]').value=s[0];document.querySelector('[name=joistDepthInches]').value=s[1];}
                ">
                  <option value="2x6" ${e.joistSize==="2x6"?"selected":""}>2\xD76 SPF</option>
                  <option value="2x8" ${e.joistSize==="2x8"?"selected":""}>2\xD78 SPF</option>
                  <option value="2x10" ${e.joistSize==="2x10"||!e.joistSize?"selected":""}>2\xD710 SPF</option>
                  <option value="2x12" ${e.joistSize==="2x12"?"selected":""}>2\xD712 SPF</option>
                  <option value="lvl-9.5" ${e.joistSize==="lvl-9.5"?"selected":""}>LVL 1.75\xD79.5</option>
                  <option value="lvl-11.875" ${e.joistSize==="lvl-11.875"?"selected":""}>LVL 1.75\xD711.875</option>
                  <option value="i-joist-9.5" ${e.joistSize==="i-joist-9.5"?"selected":""}>I-Joist 9.5"</option>
                  <option value="i-joist-11.875" ${e.joistSize==="i-joist-11.875"?"selected":""}>I-Joist 11.875"</option>
                </select>
              </div>
              <div class="form-field">
                <label class="form-label">Width</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="joistWidthInches" value="${e.joistWidthInches||1.5}" min="0.5" max="4" step="0.25" readonly>
                  <span class="input-group__suffix">in</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Depth</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="joistDepthInches" value="${e.joistDepthInches||9.25}" min="3" max="16" step="0.125" readonly>
                  <span class="input-group__suffix">in</span>
                </div>
              </div>
            </div>
          </div>
          <div class="form-section">
            <div class="form-section__title">Load & Material</div>
            <div class="form-grid form-grid--3col">
              <div class="form-field">
                <label class="form-label">Live Load</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="liveLoadPsft" value="${e.liveLoadPsft||40}" min="10" max="100">
                  <span class="input-group__suffix">psf</span>
                </div>
                <p class="form-help">Residential: 40 psf</p>
              </div>
              <div class="form-field">
                <label class="form-label">Dead Load</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="deadLoadPsft" value="${e.deadLoadPsft||10}" min="5" max="50">
                  <span class="input-group__suffix">psf</span>
                </div>
                <p class="form-help">Tile: ~15 psf</p>
              </div>
              <div class="form-field">
                <label class="form-label">Modulus (E)</label>
                <select class="form-select" name="modulusPsi">
                  <option value="1400000" ${e.modulusPsi==14e5?"selected":""}>SPF #2 (1.4M psi)</option>
                  <option value="1600000" ${e.modulusPsi==16e5||!e.modulusPsi?"selected":""}>SPF #1 (1.6M psi)</option>
                  <option value="1900000" ${e.modulusPsi==19e5?"selected":""}>LVL (1.9M psi)</option>
                </select>
              </div>
            </div>
          </div>
        `,"heated-floor":`
          <div class="form-section">
            <div class="form-section__title">Heated Area</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label form-label--required">Area to Heat</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="areaSqFt" value="${e.areaSqFt||""}" min="1" max="500" step="1" placeholder="e.g. 60">
                  <span class="input-group__suffix">sq ft</span>
                </div>
                <p class="form-help">Heated area only (exclude under fixtures)</p>
              </div>
              <div class="form-field">
                <label class="form-label">Watts per Sq Ft</label>
                <select class="form-select" name="wattsPerSqFt">
                  <option value="10" ${e.wattsPerSqFt==10?"selected":""}>10 W/sf (supplemental)</option>
                  <option value="12" ${e.wattsPerSqFt==12||!e.wattsPerSqFt?"selected":""}>12 W/sf (standard)</option>
                  <option value="15" ${e.wattsPerSqFt==15?"selected":""}>15 W/sf (cold climate/primary)</option>
                </select>
                <p class="form-help">Per heating mat specs</p>
              </div>
            </div>
            ${s({title:"Sq Ft Helper (Heated Area)",targetFloorName:"areaSqFt",includeHeight:!1,note:"Exclude area under vanity/toilet/tub where heat will not run."})}
          </div>
          <div class="form-section">
            <div class="form-section__title">Electrical Configuration</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label">Voltage</label>
                <select class="form-select" name="voltage">
                  <option value="120" ${e.voltage==120||!e.voltage?"selected":""}>120V (typical)</option>
                  <option value="240" ${e.voltage==240?"selected":""}>240V (larger areas)</option>
                </select>
              </div>
              <div class="form-field">
                <label class="form-label">Thermostat Limit</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="thermostatMaxAmps" value="${e.thermostatMaxAmps||15}" min="10" max="20">
                  <span class="input-group__suffix">A</span>
                </div>
                <p class="form-help">15A typical; above needs relay</p>
              </div>
            </div>
          </div>
        `,"thinset-mix":`
          <div class="form-section">
            <div class="form-section__title">Product Specs (from TDS)</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label">Bag Weight</label>
                <select class="form-select" name="bagWeightLbs">
                  <option value="25" ${e.bagWeightLbs==25?"selected":""}>25 lb bag</option>
                  <option value="50" ${e.bagWeightLbs==50||!e.bagWeightLbs?"selected":""}>50 lb bag</option>
                </select>
              </div>
              <div class="form-field">
                <label class="form-label">Yield per Bag</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="yieldCuFtPerBag" value="${e.yieldCuFtPerBag||.45}" min="0.1" max="1" step="0.01">
                  <span class="input-group__suffix">cu ft</span>
                </div>
                <p class="form-help">~0.45 cu ft typical for 50 lb</p>
              </div>
            </div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label">Water Range (Min)</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="waterQuartsPerBagMin" value="${e.waterQuartsPerBagMin||5}" min="1" max="10" step="0.25">
                  <span class="input-group__suffix">qt</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Water Range (Max)</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="waterQuartsPerBagMax" value="${e.waterQuartsPerBagMax||6}" min="1" max="10" step="0.25">
                  <span class="input-group__suffix">qt</span>
                </div>
              </div>
            </div>
          </div>
          <div class="form-section">
            <div class="form-section__title">Batch Size (Optional)</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label">Batch Weight</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="batchWeightLbs" value="${e.batchWeightLbs||""}" min="1" max="50" step="1" placeholder="Leave blank for full bag">
                  <span class="input-group__suffix">lbs</span>
                </div>
                <p class="form-help">For partial batches</p>
              </div>
              <div class="form-field">
                <label class="form-label">Pot Life</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="potLifeMinutes" value="${e.potLifeMinutes||120}" min="30" max="240">
                  <span class="input-group__suffix">min</span>
                </div>
                <p class="form-help">Working time (~2 hrs typical)</p>
              </div>
            </div>
          </div>
        `,primer:`
          <div class="form-section">
            <div class="form-section__title">Surface Details</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label form-label--required">Area to Prime</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="areaSqFt" value="${e.areaSqFt||""}" min="1" max="5000" step="1" placeholder="e.g. 200">
                  <span class="input-group__suffix">sq ft</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Surface Porosity</label>
                <select class="form-select" name="porosity">
                  <option value="porous" ${e.porosity==="porous"||!e.porosity?"selected":""}>Porous (concrete, plywood)</option>
                  <option value="nonPorous" ${e.porosity==="nonPorous"?"selected":""}>Non-Porous (VCT, sealed)</option>
                </select>
                <p class="form-help">Affects absorption rate</p>
              </div>
            </div>
            ${s({title:"Sq Ft Helper (Surface)",targetFloorName:"areaSqFt",includeHeight:!1})}
            <div class="form-field">
              <label class="form-label">
                <input type="checkbox" name="doublePrime" ${e.doublePrime?"checked":""}>
                Double Prime (2 coats)
              </label>
              <p class="form-help">Recommended for very porous substrates</p>
            </div>
          </div>
        `,"deck-mud":`
          <div class="form-section">
            <div class="form-section__title">Shower Pan Dimensions</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label form-label--required">Pan Area</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="areaSqFt" value="${e.areaSqFt||""}" min="1" max="100" step="0.5" placeholder="e.g. 12">
                  <span class="input-group__suffix">sq ft</span>
                </div>
                <p class="form-help">L \xD7 W of shower floor</p>
              </div>
              <div class="form-field">
                <label class="form-label">Run to Drain</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="runFeet" value="${e.runFeet||""}" min="0.5" max="10" step="0.5" placeholder="Auto from area">
                  <span class="input-group__suffix">ft</span>
                </div>
                <p class="form-help">Distance from perimeter to drain</p>
              </div>
            </div>
            ${s({title:"Sq Ft Helper (Pan)",targetFloorName:"areaSqFt",includeHeight:!1,note:"Use the inside pan dimensions (wall-to-wall). Curb thickness is separate."})}
          </div>
          <div class="form-section">
            <div class="form-section__title">Mud Bed Specs (TCNA B415/B421)</div>
            <div class="form-grid form-grid--3col">
              <div class="form-field">
                <label class="form-label">Min Thickness (at drain)</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="minThicknessInches" value="${e.minThicknessInches||1.25}" min="0.75" max="2" step="0.25">
                  <span class="input-group__suffix">in</span>
                </div>
                <p class="form-help">Min 1.25" per TCNA</p>
              </div>
              <div class="form-field">
                <label class="form-label">Slope</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="slopeInchesPerFoot" value="${e.slopeInchesPerFoot||.25}" min="0.125" max="0.5" step="0.125">
                  <span class="input-group__suffix">in/ft</span>
                </div>
                <p class="form-help">\xBC"/ft standard</p>
              </div>
              <div class="form-field">
                <label class="form-label">Bag Yield</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="bagYieldCuFt" value="${e.bagYieldCuFt||.5}" min="0.3" max="0.7" step="0.05">
                  <span class="input-group__suffix">cu ft</span>
                </div>
                <p class="form-help">Per 50 lb bag (~0.5)</p>
              </div>
            </div>
          </div>
        `,sealant:`
          <div class="form-section">
            <div class="form-section__title">Joint Details</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label form-label--required">Linear Feet of Joints</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="linearFeet" value="${e.linearFeet||""}" min="1" max="500" step="1" placeholder="e.g. 50">
                  <span class="input-group__suffix">ft</span>
                </div>
                <p class="form-help">Total caulk line length</p>
              </div>
              <div class="form-field">
                <label class="form-label">Bead Diameter</label>
                <select class="form-select" name="beadDiameterInches">
                  <option value="0.125" ${e.beadDiameterInches==.125?"selected":""}>\u215B" (thin)</option>
                  <option value="0.1875" ${e.beadDiameterInches==.1875?"selected":""}>3/16" (standard)</option>
                  <option value="0.25" ${e.beadDiameterInches==.25||!e.beadDiameterInches?"selected":""}>\xBC" (typical)</option>
                  <option value="0.375" ${e.beadDiameterInches==.375?"selected":""}>\u215C" (wide joints)</option>
                </select>
                <p class="form-help">Joint width after tooling</p>
              </div>
            </div>
          </div>
          <div class="form-section">
            <div class="form-section__title">Tube Size</div>
            <div class="form-field" style="max-width: 300px;">
              <label class="form-label">Cartridge Size</label>
              <select class="form-select" name="tubeVolumeOz">
                <option value="10.1" ${e.tubeVolumeOz==10.1||!e.tubeVolumeOz?"selected":""}>10.1 oz (standard)</option>
                <option value="28" ${e.tubeVolumeOz==28?"selected":""}>28 oz (sausage)</option>
              </select>
            </div>
          </div>
        `,sealer:`
          <div class="form-section">
            <div class="form-section__title">Surface to Seal</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label form-label--required">Area</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="areaSqFt" value="${e.areaSqFt||""}" min="1" max="5000" step="1" placeholder="e.g. 150">
                  <span class="input-group__suffix">sq ft</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Surface Type</label>
                <select class="form-select" name="surface">
                  <option value="polished" ${e.surface==="polished"?"selected":""}>Polished Porcelain / Dense Stone</option>
                  <option value="semi_porcelain" ${e.surface==="semi_porcelain"?"selected":""}>Semi-Porous Porcelain</option>
                  <option value="natural_stone" ${e.surface==="natural_stone"||!e.surface?"selected":""}>Natural Stone (honed/rough)</option>
                  <option value="concrete" ${e.surface==="concrete"?"selected":""}>Concrete / Broom Finish</option>
                </select>
                <p class="form-help">Affects absorption/coverage</p>
              </div>
            </div>
            ${s({title:"Sq Ft Helper (Surface)",targetFloorName:"areaSqFt",includeHeight:!1})}
            <div class="form-field" style="max-width: 200px;">
              <label class="form-label">Number of Coats</label>
              <select class="form-select" name="coats">
                <option value="1" ${e.coats==1?"selected":""}>1 coat</option>
                <option value="2" ${e.coats==2||!e.coats?"selected":""}>2 coats</option>
                <option value="3" ${e.coats==3?"selected":""}>3 coats</option>
              </select>
            </div>
          </div>
        `,movement:`
          <div class="form-section">
            <div class="form-section__title">Floor Dimensions</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label form-label--required">Length</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="lengthFt" value="${e.lengthFt||""}" min="1" max="500" step="0.5" placeholder="e.g. 40">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label form-label--required">Width</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="widthFt" value="${e.widthFt||""}" min="1" max="500" step="0.5" placeholder="e.g. 30">
                  <span class="input-group__suffix">ft</span>
                </div>
              </div>
            </div>
          </div>
          <div class="form-section">
            <div class="form-section__title">Exposure Conditions</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label">Exposure Type</label>
                <select class="form-select" name="exposure">
                  <option value="interior" ${e.exposure==="interior"||!e.exposure?"selected":""}>Interior (conditioned)</option>
                  <option value="exterior" ${e.exposure==="exterior"?"selected":""}>Exterior</option>
                </select>
              </div>
              <div class="form-field">
                <label class="form-label">Temperature Swing</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="tempSwingF" value="${e.tempSwingF||30}" min="0" max="100">
                  <span class="input-group__suffix">\xB0F</span>
                </div>
                <p class="form-help">Annual max-min difference</p>
              </div>
            </div>
            <div class="form-field">
              <label class="form-label">
                <input type="checkbox" name="isSunExposed" ${e.isSunExposed?"checked":""}>
                Sun-exposed or heated slab
              </label>
              <p class="form-help">Reduces joint spacing (8\u201312 ft grid)</p>
            </div>
          </div>
        `,moisture:`
          <div class="form-section">
            <div class="form-section__title">Moisture Test Results</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label form-label--required">MVER (ASTM F1869)</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="mverLbs" value="${e.mverLbs||""}" min="0" max="30" step="0.5" placeholder="e.g. 3">
                  <span class="input-group__suffix">lbs/1000sf/24h</span>
                </div>
                <p class="form-help">Calcium chloride test result</p>
              </div>
              <div class="form-field">
                <label class="form-label form-label--required">RH % (ASTM F2170)</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="rhPercent" value="${e.rhPercent||""}" min="0" max="100" step="1" placeholder="e.g. 75">
                  <span class="input-group__suffix">%</span>
                </div>
                <p class="form-help">In-situ probe at 40% depth</p>
              </div>
            </div>
          </div>
          <div class="form-section">
            <div class="form-section__title">Product Limits (from TDS)</div>
            <div class="form-grid form-grid--2col">
              <div class="form-field">
                <label class="form-label">MVER Limit</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="productLimitMver" value="${e.productLimitMver||5}" min="1" max="10" step="0.5">
                  <span class="input-group__suffix">lbs</span>
                </div>
                <p class="form-help">Most SLU/adhesive: 3\u20135 lbs</p>
              </div>
              <div class="form-field">
                <label class="form-label">RH Limit</label>
                <div class="input-group">
                  <input type="number" class="form-input" name="productLimitRh" value="${e.productLimitRh||75}" min="50" max="99" step="1">
                  <span class="input-group__suffix">%</span>
                </div>
                <p class="form-help">Typical adhesive limit: 75\u201380%</p>
              </div>
            </div>
          </div>
        `},i=L.find(f=>f.id===t);return(i==null?void 0:i.status)==="coming"||!o[t]?`
          <div class="calc-coming-soon">
            <div class="calc-coming-soon__icon">\u{1F6A7}</div>
            <h3 class="calc-coming-soon__title">${(i==null?void 0:i.name)||"Calculator"} Coming Soon</h3>
            <p class="calc-coming-soon__text">This calculator is under development. We're working on TCNA-compliant formulas and will release it soon.</p>
            <div class="calc-coming-soon__actions">
              <button type="button" class="btn btn--secondary" onclick="window.TillerApp.Router.navigate('calculators'); window.TillerApp.State.activeCalculator = 'tile';">
                \u2190 Try Tile Calculator
              </button>
            </div>
          </div>
        `:`
        <form class="calc-form" data-calc="${t}">
          ${o[t]}
          <div class="mt-xl" style="display: flex; gap: 1rem; flex-wrap: wrap;">
            <button type="submit" class="btn btn--calculate">
              <span>\u26A1</span> Calculate
            </button>
            <button type="button" class="btn btn--secondary" onclick="window.TillerApp.clearCalculator('${t}')">
              <span>\u{1F504}</span> Clear
            </button>
          </div>
          ${a?this.renderResults(t,a):""}
        </form>
      `},renderResults(t,e){var m,u,b;if(!e)return"";const s={tile:[{key:"areaWithWaste",label:"Area with Waste",suffix:" sq ft"},{key:"tilesNeeded",label:"Tiles Needed"},{key:"boxes",label:"Boxes",highlight:!0}],mortar:[{key:"bagsMin",label:"Min Bags"},{key:"bagsMax",label:"Max Bags",highlight:!0},{key:"coverage",label:"Coverage"}],grout:[{key:"pounds",label:"Grout (lbs)"},{key:"bags25lb",label:"25 lb Bags",highlight:!0},{key:"bags10lb",label:"10 lb Bags"},{key:"coverage",label:"Coverage",suffix:" sqft/lb"}],leveling:[{key:"volume",label:"Volume",suffix:" cu ft"},{key:"bags",label:"Bags (50 lb)",highlight:!0}],slope:[{key:"riseAtWall",label:"Rise at Wall",suffix:'"'},{key:"area",label:"Floor Area",suffix:" sq ft"},{key:"deckMudCuFt",label:"Deck Mud",suffix:" cu ft"},{key:"bags60lb",label:"60 lb Bags",highlight:!0}],waterproof:[{key:"membrane",label:"Membrane",suffix:" gal",highlight:!0},{key:"bandFeet",label:"Seam Band",suffix:" ft"},{key:"coats",label:"Coats Required"}],"bath-layout":[{key:"layoutWall",label:"Fixtures On"},{key:"fitsLinear",label:"Wall Fit"},{key:"availableWallIn",label:"Available Wall",suffix:" in"},{key:"requiredWallIn",label:"Required Wall",suffix:" in"},{key:"walkwayPass",label:"Walkway OK"},{key:"walkwayWidthIn",label:"Clear Path",suffix:" in",highlight:!0},{key:"maxDepthClearIn",label:"Deepest Fixture + Clear",suffix:" in"}],labor:[{key:"hours",label:"Est. Hours"},{key:"days",label:"Est. Days",highlight:!0},{key:"rate",label:"Production Rate"}],crown:[{key:"perimeter",label:"Ceiling Perimeter",suffix:" ft"},{key:"linearFt",label:"Linear Ft (w/ waste)",suffix:" ft"},{key:"pieces",label:"Pieces Needed",highlight:!0},{key:"insideCorners",label:"Inside Corners"},{key:"outsideCorners",label:"Outside Corners"},{key:"materialCost",label:"Est. Material",prefix:"$"}],baseboard:[{key:"netPerimeter",label:"Net Perimeter",suffix:" ft"},{key:"linearFt",label:"Baseboard (w/ waste)",suffix:" ft"},{key:"panelFramingFt",label:"Panel Framing",suffix:" ft"},{key:"totalPieces",label:"Total Pieces",highlight:!0},{key:"materialCost",label:"Est. Material",prefix:"$"}],quarter:[{key:"grossPerimeter",label:"Gross Perimeter",suffix:" ft"},{key:"deductions",label:"Deductions",suffix:" ft"},{key:"linearFt",label:"Linear Ft (w/ waste)",suffix:" ft"},{key:"pieces",label:"Pieces Needed",highlight:!0},{key:"materialCost",label:"Est. Material",prefix:"$"}],deflection:[{key:"deflectionRatio",label:"Deflection Ratio",prefix:"L/"},{key:"passesCeramic",label:"Ceramic (L/360)",transform:c=>c?"\u2705 Pass":"\u274C Fail"},{key:"passesStone",label:"Stone (L/720)",transform:c=>c?"\u2705 Pass":"\u274C Fail",highlight:!0},{key:"deltaInches",label:"Max Deflection",suffix:'"'}],"heated-floor":[{key:"totalWatts",label:"Total Watts",suffix:" W"},{key:"amps",label:"Amp Draw",suffix:" A",highlight:!0},{key:"breakerAmps",label:"Breaker Size",suffix:" A"},{key:"circuits",label:"Circuits Needed"},{key:"needsRelay",label:"External Relay",transform:c=>c?"\u26A0\uFE0F Yes":"No"}],"thinset-mix":[{key:"batchWeightLbs",label:"Batch Weight",suffix:" lbs"},{key:"waterQuartsRange",label:"Water Range",transform:c=>c?`${c[0]}\u2013${c[1]} qt`:"\u2014",highlight:!0},{key:"estimatedYieldCuFt",label:"Est. Yield",suffix:" cu ft"},{key:"potLifeMinutes",label:"Pot Life",suffix:" min"}],primer:[{key:"gallons",label:"Primer Needed",suffix:" gal",highlight:!0},{key:"coats",label:"Coats"},{key:"coverageUsed",label:"Coverage Used",suffix:" sf/gal"}],"deck-mud":[{key:"volumeCuFt",label:"Volume",suffix:" cu ft"},{key:"bags",label:"Bags (50 lb)",highlight:!0},{key:"avgThicknessInches",label:"Avg Thickness",suffix:'"'}],sealant:[{key:"tubes",label:"Tubes Needed",highlight:!0},{key:"totalVolumeCuIn",label:"Total Volume",suffix:" cu in"}],sealer:[{key:"gallons",label:"Sealer Needed",suffix:" gal",highlight:!0},{key:"coverageUsedSqFtPerGal",label:"Coverage Rate",suffix:" sf/gal"}],movement:[{key:"spacingFt",label:"Joint Spacing",suffix:" ft",highlight:!0},{key:"jointsLong",label:"Joints (Length)"},{key:"jointsShort",label:"Joints (Width)"},{key:"totalJoints",label:"Total Joints"}],moisture:[{key:"mverPass",label:"MVER Test",transform:c=>c?"\u2705 Pass":"\u274C Fail"},{key:"rhPass",label:"RH Test",transform:c=>c?"\u2705 Pass":"\u274C Fail"},{key:"requiresMitigation",label:"Needs Mitigation",transform:c=>c?"\u26A0\uFE0F Yes":"\u2705 No",highlight:!0}]}[t]||[],o=c=>{const v=e[c.key];return v==null?"\u2014":c.transform?c.transform(v):`${c.prefix||""}${v}${c.suffix||""}`},i=r.calculatorInputs[t]||{},p=le(t,i),l=p.length>0?`
        <div class="calc-results__shop">
          <h5 class="calc-results__shop-title">\u{1F6D2} Shop This Material</h5>
          <div class="shop-links">
            ${p.map(c=>`
              <a href="${c.url}" 
                 class="shop-link" 
                 target="_blank" 
                 rel="noopener sponsored"
                 data-retailer="${c.id}"
                 onclick="window.TillerApp.trackShopClick('${c.id}', '${t}')"
                 title="Search ${c.name} for ${c.searchTerm}">
                <span class="shop-link__icon">${c.icon}</span>
                <span class="shop-link__name">${c.name}</span>
              </a>
            `).join("")}
            <button type="button" class="shop-link shop-link--local" onclick="window.TillerApp.findLocalSuppliers('${t}')">
              <span class="shop-link__icon">\u{1F4CD}</span>
              <span class="shop-link__name">Local Stores</span>
            </button>
          </div>
        </div>
      `:"",h=r.settings.autoSave?`
        <div class="autosave-indicator" id="autosave-${t}">
          <span class="autosave-icon">\u{1F4BE}</span>
          <span class="autosave-text">Auto-saved to project</span>
        </div>
      `:`
        <button type="button" class="btn btn--secondary btn--sm" onclick="window.TillerApp.saveToProject('${t}')">
          \u{1F4BE} Save to Project
        </button>
      `,n=U(t),d=n?`
        <div class="result-pro-tip">
          <div class="result-pro-tip__header">
            <span class="result-pro-tip__icon">\u{1F4A1}</span>
            <span class="result-pro-tip__label">Pro Tip</span>
          </div>
          <p class="result-pro-tip__text">${n.tip}</p>
        </div>
      `:"";return`
        <div class="calc-results">
          <h4 class="calc-results__title">Results</h4>
          <div class="calc-results__grid">
            ${s.map(c=>`
              <div class="calc-result">
                <div class="calc-result__label">${c.label}</div>
                <div class="calc-result__value ${c.highlight?"calc-result__value--highlight":""}">
                  ${o(c)}
                </div>
              </div>
            `).join("")}
          </div>
          ${e.note?`<p class="calc-results__note">${e.note}</p>`:""}
          ${e.warning?`<p class="calc-results__warning">\u26A0\uFE0F ${e.warning}</p>`:""}
          ${(m=e.assumptions)!=null&&m.length?`<details class="calc-results__assumptions"><summary>Assumptions</summary><ul>${e.assumptions.map(c=>`<li>${c}</li>`).join("")}</ul></details>`:""}
          ${(u=e.warnings)!=null&&u.length?`<div class="calc-results__warnings">${e.warnings.map(c=>`<p class="calc-results__warning">\u26A0\uFE0F ${c}</p>`).join("")}</div>`:""}
          ${(b=e.notes)!=null&&b.length?`<details class="calc-results__notes"><summary>Notes</summary><ul>${e.notes.map(c=>`<li>${c}</li>`).join("")}</ul></details>`:""}
          ${d}
          ${l}
          <div class="mt-lg calc-results__actions">
            ${h}
            <button type="button" class="btn btn--ghost btn--sm" onclick="window.TillerApp.downloadCalcPDF('${t}')" title="Download PDF">
              \u{1F4C4} Export PDF
            </button>
            <a href="#/projects" class="btn btn--ghost btn--sm" title="View Project">
              \u{1F4C1} View Project
            </a>
          </div>
        </div>
      `},attachCalculatorListeners(){document.querySelectorAll(".calc-form").forEach(t=>{t.addEventListener("submit",async e=>{e.preventDefault();const a=t.dataset.calc,s=t.querySelector(".btn--calculate"),o=new FormData(t),i={};s&&(s.classList.add("is-calculating"),s.innerHTML="<span>\u23F3</span> Calculating..."),o.forEach((l,h)=>{var n;((n=t.querySelector(`[name="${h}"]`))==null?void 0:n.type)==="checkbox"?i[h]=t.querySelector(`[name="${h}"]`).checked:i[h]=l===""?null:isNaN(l)?l:parseFloat(l)}),t.querySelectorAll('input[type="checkbox"]').forEach(l=>{i.hasOwnProperty(l.name)||(i[l.name]=l.checked)}),r.calculatorInputs[a]=i,await new Promise(l=>setTimeout(l,150));const p=ne[a];if(p){const l=p(i);l?(r.calculatorResults[a]=l,r.settings.autoSave&&$.autoSaveToProject(a,i,l),g.show("Calculation complete","success")):g.show("Please fill in required fields","warning")}this.calculators()}),t.querySelectorAll("input, select").forEach(e=>{e.addEventListener("change",()=>{const a=t.dataset.calc,s=t.querySelector('button[type="submit"]');s&&s.click()})})})},projects(){const t=document.getElementById("app-content");if(!t)return;const e=r.projects;t.innerHTML=`
        <div class="projects-view">
          <!-- Header -->
          <div class="view-header">
            <div class="view-header__info">
              <h2 class="view-header__title">Projects</h2>
              <p class="view-header__subtitle">${e.length} saved project${e.length!==1?"s":""}</p>
            </div>
            <div class="view-header__actions">
              <button class="btn btn--primary" onclick="window.TillerApp.createNewProject()">
                <span>\u2795</span> New Project
              </button>
              <button class="btn btn--secondary" onclick="document.getElementById('import-input').click()">
                <span>\u{1F4E5}</span> Import
              </button>
              <input type="file" id="import-input" accept=".json" hidden onchange="window.TillerApp.Storage.importData(this.files[0])">
              ${e.length>0?`
                <button class="btn btn--secondary" onclick="window.TillerApp.Storage.exportData()">
                  <span>\u{1F4E4}</span> Export All
                </button>
              `:""}
            </div>
          </div>

          ${e.length>0?`
            <!-- Project Grid -->
            <div class="project-grid">
              ${e.map(a=>`
                <article class="project-card" data-project-id="${a.id}">
                  <div class="project-card__header">
                    <div class="project-card__icon">\u{1F4CB}</div>
                    <div class="project-card__info">
                      <h3 class="project-card__name">${this.escapeHtml(a.name)}</h3>
                      <time class="project-card__date">Updated ${this.formatDate(a.updatedAt)}</time>
                    </div>
                  </div>
                  
                  <div class="project-card__stats">
                    <div class="project-card__stat">
                      <span class="project-card__stat-value">${a.totalArea||0}</span>
                      <span class="project-card__stat-label">sq ft</span>
                    </div>
                    <div class="project-card__stat">
                      <span class="project-card__stat-value">${Object.keys(a.calculations||{}).length}</span>
                      <span class="project-card__stat-label">calcs</span>
                    </div>
                  </div>

                  <div class="project-card__actions">
                    <button class="btn btn--primary btn--sm" onclick="window.TillerApp.openProject('${a.id}')">
                      Open
                    </button>
                    <div class="project-card__tools">
                      <button class="icon-btn" onclick="window.TillerApp.downloadProjectPDF('${a.id}')" title="Download PDF">
                        <span>\u{1F4C4}</span>
                      </button>
                      <button class="icon-btn" onclick="window.TillerApp.Projects.exportToClipboard('${a.id}')" title="Copy to clipboard">
                        <span>\u{1F4CB}</span>
                      </button>
                      <button class="icon-btn" onclick="window.TillerApp.Projects.duplicate('${a.id}'); window.TillerApp.Views.projects();" title="Duplicate">
                        <span>\u{1F4D1}</span>
                      </button>
                      <button class="icon-btn icon-btn--danger" onclick="window.TillerApp.deleteProject('${a.id}')" title="Delete">
                        <span>\u{1F5D1}\uFE0F</span>
                      </button>
                    </div>
                  </div>
                </article>
              `).join("")}
            </div>
          `:`
            <!-- Empty State -->
            <div class="empty-state empty-state--large">
              <div class="empty-state__icon">\u{1F4C1}</div>
              <h3 class="empty-state__title">No projects yet</h3>
              <p class="empty-state__text">Create your first project to save calculations, track materials, and export professional estimates.</p>
              <button class="btn btn--primary btn--lg" onclick="window.TillerApp.createNewProject()">
                <span>\u2795</span> Create First Project
              </button>
            </div>
          `}
        </div>
      `},settings(){const t=document.getElementById("app-content");if(!t)return;const e=r.settings,a=F.isConnected;t.innerHTML=`
        <div class="settings-view">
          <!-- Header -->
          <div class="view-header">
            <div class="view-header__info">
              <h2 class="view-header__title">Settings</h2>
              <p class="view-header__subtitle">Configure your TillerPro experience</p>
            </div>
          </div>

          <div class="settings-grid">
            <!-- Preferences -->
            <section class="settings-card">
              <div class="settings-card__header">
                <span class="settings-card__icon">\u2699\uFE0F</span>
                <h3 class="settings-card__title">Preferences</h3>
              </div>
              <div class="settings-card__body">
                <div class="setting-row">
                  <div class="setting-row__info">
                    <div class="setting-row__label">Auto-save</div>
                    <div class="setting-row__desc">Automatically save changes to localStorage</div>
                  </div>
                  <label class="toggle">
                    <input type="checkbox" ${e.autoSave?"checked":""} onchange="window.TillerApp.updateSetting('autoSave', this.checked)">
                    <span class="toggle__track"></span>
                  </label>
                </div>
                <div class="setting-row">
                  <div class="setting-row__info">
                    <div class="setting-row__label">Notifications</div>
                    <div class="setting-row__desc">Show toast notifications for actions</div>
                  </div>
                  <label class="toggle">
                    <input type="checkbox" ${e.notifications?"checked":""} onchange="window.TillerApp.updateSetting('notifications', this.checked)">
                    <span class="toggle__track"></span>
                  </label>
                </div>
              </div>
            </section>

            <!-- Toolkit Integration -->
            <section class="settings-card">
              <div class="settings-card__header">
                <span class="settings-card__icon">\u{1F50C}</span>
                <h3 class="settings-card__title">Toolkit Integration</h3>
                <span class="settings-card__badge ${a?"settings-card__badge--success":""}">
                  ${a?"\u25CF Connected":"\u25CB Offline"}
                </span>
              </div>
              <div class="settings-card__body">
                <p class="settings-card__text">
                  Connect to the Tillerstead Toolkit backend for enhanced calculations and cloud sync.
                </p>
                <div class="setting-row">
                  <div class="setting-row__info">
                    <div class="setting-row__label">API Endpoint</div>
                    <div class="setting-row__desc">${k.API_BASE_URL||"Not configured"}</div>
                  </div>
                  <button class="btn btn--sm btn--secondary" onclick="window.TillerApp.API.checkHealth().then(() => window.TillerApp.Views.settings())">
                    Test Connection
                  </button>
                </div>
                ${a?`
                  <div class="setting-actions">
                    <button class="btn btn--sm btn--secondary" onclick="window.TillerApp.syncToToolkit()">
                      <span>\u2B06\uFE0F</span> Push to Toolkit
                    </button>
                    <button class="btn btn--sm btn--secondary" onclick="window.TillerApp.syncFromToolkit()">
                      <span>\u2B07\uFE0F</span> Pull from Toolkit
                    </button>
                  </div>
                `:""}
              </div>
            </section>

            <!-- Data Management -->
            <section class="settings-card">
              <div class="settings-card__header">
                <span class="settings-card__icon">\u{1F4BE}</span>
                <h3 class="settings-card__title">Data Management</h3>
              </div>
              <div class="settings-card__body">
                <div class="setting-row">
                  <div class="setting-row__info">
                    <div class="setting-row__label">Local Storage</div>
                    <div class="setting-row__desc">${r.projects.length} projects saved locally</div>
                  </div>
                </div>
                <div class="setting-actions">
                  <button class="btn btn--sm btn--secondary" onclick="window.TillerApp.Storage.exportData()">
                    <span>\u{1F4E4}</span> Export Data
                  </button>
                  <button class="btn btn--sm btn--secondary" onclick="document.getElementById('settings-import').click()">
                    <span>\u{1F4E5}</span> Import Data
                  </button>
                  <input type="file" id="settings-import" accept=".json" hidden onchange="window.TillerApp.Storage.importData(this.files[0])">
                </div>
                <div class="setting-row setting-row--danger">
                  <div class="setting-row__info">
                    <div class="setting-row__label">Clear All Data</div>
                    <div class="setting-row__desc">Permanently delete all projects and settings</div>
                  </div>
                  <button class="btn btn--sm btn--danger" onclick="if(confirm('Delete all data? This cannot be undone.')){window.TillerApp.Storage.clearAll(); window.TillerApp.Views.settings();}">
                    Clear Data
                  </button>
                </div>
              </div>
            </section>

            <!-- About -->
            <section class="settings-card">
              <div class="settings-card__header">
                <span class="settings-card__icon">\u2139\uFE0F</span>
                <h3 class="settings-card__title">About TillerPro</h3>
              </div>
              <div class="settings-card__body">
                <div class="about-info">
                  <div class="about-info__row">
                    <span>Version</span>
                    <span>1.0.0</span>
                  </div>
                  <div class="about-info__row">
                    <span>Developer</span>
                    <span>Tillerstead LLC</span>
                  </div>
                  <div class="about-info__row">
                    <span>NJ HIC License</span>
                    <span>#13VH10808800</span>
                  </div>
                  <div class="about-info__row">
                    <span>Standards</span>
                    <span>TCNA 2024 Compliant</span>
                  </div>
                </div>
                <p class="settings-card__text" style="margin-top: var(--space-lg);">
                  Professional tile calculators built by a licensed contractor in New Jersey.
                </p>
              </div>
            </section>
          </div>
        </div>
      `},escapeHtml(t){const e=document.createElement("div");return e.textContent=t||"",e.innerHTML},formatDate(t){const e=new Date(t),s=new Date-e,o=Math.floor(s/(1e3*60*60*24));return o===0?"Today":o===1?"Yesterday":o<7?`${o} days ago`:e.toLocaleDateString()}},ce={init(){document.addEventListener("keydown",t=>{var e;if(t.ctrlKey&&t.key==="s"&&(t.preventDefault(),T.save(),g.show("Saved","success")),t.ctrlKey&&t.key==="n"&&(t.preventDefault(),$.createNewProject()),t.key==="Escape"&&(I.hide(),document.getElementById("app-sidebar").classList.remove("is-open"),(e=document.querySelector(".sidebar-overlay"))==null||e.classList.remove("is-visible")),!t.ctrlKey&&!t.altKey&&!t.metaKey){const a=["dashboard","calculators","projects","settings"],s=parseInt(t.key);s>=1&&s<=4&&document.activeElement.tagName!=="INPUT"&&j.navigate(a[s-1])}})}},O={register(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registered:",t.scope)}).catch(t=>{console.log("SW registration failed:",t)})},updateOnlineStatus(){const t=document.getElementById("app-status");if(t){const e=navigator.onLine;t.innerHTML=`
          <span class="status-dot status-dot--${e?"online":"offline"}"></span>
          ${e?"Online":"Offline"}
        `}}};function de(){const t=document.getElementById("app-loading"),e=document.getElementById("app-shell");t&&(t.style.display="none",t.hidden=!0),e&&e.classList.add("is-ready")}const $={async init(){var t,e,a,s,o,i;try{T.load(),j.init(),ce.init(),O.register(),F.checkHealth().then(p=>{p&&g.show("Connected to Toolkit API","success")}).catch(()=>{}),setInterval(()=>F.checkHealth(),3e4),window.addEventListener("online",()=>{O.updateOnlineStatus(),F.checkHealth()}),window.addEventListener("offline",()=>{O.updateOnlineStatus(),F.isConnected=!1,F.updateConnectionUI(!1)}),O.updateOnlineStatus(),(t=document.getElementById("sidebar-toggle"))==null||t.addEventListener("click",()=>{const p=document.getElementById("app-sidebar");p.classList.toggle("is-open"),this.toggleOverlay(p.classList.contains("is-open"))}),(e=document.getElementById("sidebar-close"))==null||e.addEventListener("click",()=>{document.getElementById("app-sidebar").classList.remove("is-open"),this.toggleOverlay(!1)}),(a=document.getElementById("modal-close"))==null||a.addEventListener("click",()=>I.hide()),(s=document.getElementById("modal-overlay"))==null||s.addEventListener("click",p=>{p.target.id==="modal-overlay"&&I.hide()}),(o=document.getElementById("new-project-btn"))==null||o.addEventListener("click",()=>this.createNewProject()),(i=document.getElementById("save-btn"))==null||i.addEventListener("click",()=>{T.save(),g.show("Saved","success")}),S.updateCount()}catch(p){console.error("TillerPro init error:",p);try{g.show("App initialization error","error")}catch(l){}}finally{de()}},toggleOverlay(t){let e=document.querySelector(".sidebar-overlay");e||(e=document.createElement("div"),e.className="sidebar-overlay",e.addEventListener("click",()=>{document.getElementById("app-sidebar").classList.remove("is-open"),this.toggleOverlay(!1)}),document.body.appendChild(e)),e.classList.toggle("is-visible",t)},createNewProject(){I.show({title:"New Project",body:`
          <div class="form-field">
            <label class="form-label">Project Name</label>
            <input type="text" class="form-input" id="new-project-name" placeholder="e.g., Master Bathroom Renovation" autofocus>
          </div>
        `,footer:`
          <button class="btn btn--secondary" onclick="window.TillerApp.Modal.hide()">Cancel</button>
          <button class="btn btn--primary" id="create-project-btn">Create</button>
        `});const t=document.getElementById("new-project-name"),e=document.getElementById("create-project-btn");t.addEventListener("keydown",a=>{a.key==="Enter"&&e.click()}),e.addEventListener("click",()=>{const a=t.value.trim()||"New Project",s=S.create(a);r.activeProject=s.id,I.hide(),j.navigate("calculators"),g.show(`Project "${a}" created`,"success")}),t.focus()},openProject(t){r.activeProject=t;const e=S.get(t);e&&e.calculations&&Object.entries(e.calculations).forEach(([a,s])=>{r.calculatorInputs[a]=s.inputs||{},r.calculatorResults[a]=s.results||null}),j.navigate("calculators")},deleteProject(t){I.confirm("Are you sure you want to delete this project?",()=>{S.delete(t),M.projects(),g.show("Project deleted","success")})},saveToProject(t){var a;if(!r.activeProject){this.createNewProject();return}const e=S.get(r.activeProject);e&&(e.calculations||(e.calculations={}),e.calculations[t]={inputs:r.calculatorInputs[t],results:r.calculatorResults[t],savedAt:new Date().toISOString()},t==="tile"&&((a=r.calculatorInputs[t])!=null&&a.area)&&(e.totalArea=parseFloat(r.calculatorInputs[t].area)||0),S.update(r.activeProject,e),g.show("Saved to project","success"))},autoSaveToProject(t,e,a){if(!r.activeProject&&r.settings.autoCreateProject){const o=new Date().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),i=S.create(`Project ${o}`);r.activeProject=i.id,S.updateCount()}if(!r.activeProject)return;const s=S.get(r.activeProject);s&&(s.calculations||(s.calculations={}),s.calculations[t]={inputs:e,results:a,savedAt:new Date().toISOString(),shopLinksClicked:[]},this.updateProjectTotals(s,t,e,a),this.updateShoppingList(s),S.update(r.activeProject,s),r.lastAutoSave=new Date().toISOString(),this.showAutoSaveIndicator(t))},updateProjectTotals(t,e,a,s){if(t.totals||(t.totals={area:0,materials:{},estimatedCost:0}),e==="tile"&&a.area&&(t.totals.area=parseFloat(a.area)||0,t.totalArea=t.totals.area),s){const i={tile:{key:"tiles",unit:s.boxes?"boxes":"tiles",value:s.boxes||s.tilesNeeded},mortar:{key:"mortar",unit:"bags",value:s.bags},grout:{key:"grout",unit:"bags",value:s.bags},leveling:{key:"leveling",unit:"bags",value:s.bags},waterproof:{key:"waterproof",unit:"gal",value:s.gallons},sealant:{key:"sealant",unit:"tubes",value:s.tubes},sealer:{key:"sealer",unit:"gal",value:s.gallons}}[e];i&&i.value&&(t.totals.materials[i.key]={quantity:i.value,unit:i.unit})}},updateShoppingList(t){if(!t.calculations)return;const e=[],a={tile:"Tile",mortar:"Thin-Set Mortar",grout:"Grout",leveling:"Self-Leveling Compound",waterproof:"Waterproofing Membrane",sealant:"Caulk/Sealant",sealer:"Sealer",primer:"Primer","deck-mud":"Deck Mud"};Object.entries(t.calculations).forEach(([s,o])=>{if(!o.results)return;const i=o.results,p=o.inputs||{};if(s==="tile"&&i.tilesNeeded){const l=p.tileWidth&&p.tileHeight?`${p.tileWidth}\xD7${p.tileHeight}`:"";e.push({item:l?`${l} Tile`:"Tile",quantity:i.boxes||Math.ceil(i.tilesNeeded/10),unit:i.boxes?"boxes":"tiles",source:s,spec:i.note||""})}if(s==="mortar"&&i.bags&&e.push({item:p.backButter?"LFT Thin-Set Mortar":"Thin-Set Mortar",quantity:i.bags,unit:"bags (50 lb)",source:s}),s==="grout"&&i.bags){const l=p.jointWidth||.125;e.push({item:l>.125?"Sanded Grout":"Unsanded Grout",quantity:i.bags,unit:"bags",source:s})}s==="leveling"&&i.bags&&e.push({item:"Self-Leveling Underlayment",quantity:i.bags,unit:"bags (50 lb)",source:s}),s==="waterproof"&&i.gallons&&e.push({item:"Waterproofing Membrane",quantity:i.gallons,unit:"gallons",source:s}),s==="sealant"&&i.tubes&&e.push({item:"Silicone Caulk",quantity:i.tubes,unit:"tubes",source:s}),s==="sealer"&&i.gallons&&e.push({item:"Grout/Stone Sealer",quantity:i.gallons,unit:"gallons",source:s})}),t.shoppingList=e},showAutoSaveIndicator(t){const e=document.getElementById(`autosave-${t}`);e&&(e.classList.add("is-saving"),setTimeout(()=>{e.classList.remove("is-saving")},2e3))},trackShopClick(t,e){if(r.shopLinksClicked.push({retailer:t,calculator:e,timestamp:new Date().toISOString()}),r.activeProject){const a=S.get(r.activeProject);a&&(a.retailerClicks||(a.retailerClicks=[]),a.retailerClicks.push({retailer:t,product:e,timestamp:new Date().toISOString()}),a.calculations&&a.calculations[e]&&(a.calculations[e].shopLinksClicked||(a.calculations[e].shopLinksClicked=[]),a.calculations[e].shopLinksClicked.includes(t)||a.calculations[e].shopLinksClicked.push(t)),S.update(r.activeProject,a))}},findLocalSuppliers(t){const e=ee[t],a=e?e(r.calculatorInputs[t]||{}):"tile store",s=`https://www.google.com/maps/search/tile+store+${encodeURIComponent(a)}+near+me`;window.open(s,"_blank","noopener")},clearCalculator(t){r.calculatorInputs[t]={},r.calculatorResults[t]=null,M.calculators()},updateSetting(t,e){r.settings[t]=e,T.save(),g.show("Setting updated","success")},clearAllData(){I.confirm("This will delete all projects and reset all settings. Continue?",()=>{localStorage.removeItem(k.STORAGE_KEY),r.projects=[],r.settings={autoSave:!0,notifications:!0,darkMode:!0,units:"imperial"},S.updateCount(),j.navigate("dashboard"),g.show("All data cleared","success")})},async syncToToolkit(){if(!F.isConnected){g.show("Toolkit API not connected","warning");return}try{let t=0;for(const e of r.projects)if(e.toolkit_id)await F.updateJob(e.toolkit_id,this.projectToJob(e));else{const a=await F.createJob(this.projectToJob(e));e.toolkit_id=a.id,t++}T.save(),g.show(`Synced ${t} project(s) to Toolkit`,"success")}catch(t){g.show("Sync failed: "+t.message,"error")}},async importFromToolkit(){if(!F.isConnected){g.show("Toolkit API not connected","warning");return}try{const t=await F.listJobs();let e=0;for(const a of t)if(!r.projects.some(o=>o.toolkit_id===a.id)){const o=this.jobToProject(a);S.add(o),e++}T.save(),S.updateCount(),j.navigate(r.currentRoute),g.show(`Imported ${e} job(s) from Toolkit`,"success")}catch(t){g.show("Import failed: "+t.message,"error")}},projectToJob(t){return{name:t.name||"Untitled Project",client_name:t.clientName||null,client_email:t.clientEmail||null,client_phone:t.clientPhone||null,address_line1:t.address||null,city:t.city||null,state:"NJ",zip_code:t.zip||null,status:"draft",notes:t.notes||null,labor_rate:75,overhead_percent:15,profit_percent:20}},jobToProject(t){return{id:"project_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),toolkit_id:t.id,name:t.name,clientName:t.client_name,clientEmail:t.client_email,clientPhone:t.client_phone,address:t.address_line1,city:t.city,zip:t.zip_code,notes:t.notes,totalArea:0,rooms:[],calculations:{},createdAt:t.created_at,updatedAt:t.updated_at}}};window.TillerApp={Router:j,Toast:g,Modal:I,Projects:S,Storage:T,Views:M,API:F,HybridCalculator:re,createNewProject:()=>$.createNewProject(),openProject:t=>$.openProject(t),deleteProject:t=>$.deleteProject(t),saveToProject:t=>$.saveToProject(t),clearCalculator:t=>$.clearCalculator(t),updateSetting:(t,e)=>$.updateSetting(t,e),clearAllData:()=>$.clearAllData(),autoSaveToProject:(t,e,a)=>$.autoSaveToProject(t,e,a),trackShopClick:(t,e)=>$.trackShopClick(t,e),findLocalSuppliers:t=>$.findLocalSuppliers(t),syncToToolkit:()=>$.syncToToolkit(),importFromToolkit:()=>$.importFromToolkit(),downloadProjectPDF:async t=>{const e=S.get(t);if(!e){g.show("Project not found","error");return}if(!window.TillerPDF){g.show("PDF module not loaded","error");return}if(!await window.TillerPDF.waitForLibrary()){g.show("PDF library not loaded. Please refresh.","error");return}g.show("Generating PDF...","info");const s=await window.TillerPDF.downloadProjectSummary(e);s.success?g.show(`Downloaded: ${s.filename}`,"success"):g.show(`PDF failed: ${s.error}`,"error")},downloadMaterialsPDF:async t=>{const e=S.get(t);if(!e){g.show("Project not found","error");return}if(!window.TillerPDF){g.show("PDF module not loaded","error");return}if(!await window.TillerPDF.waitForLibrary()){g.show("PDF library not loaded. Please refresh.","error");return}g.show("Generating PDF...","info");const s=await window.TillerPDF.downloadMaterialList(e);s.success?g.show(`Downloaded: ${s.filename}`,"success"):g.show(`PDF failed: ${s.error}`,"error")},downloadCalcPDF:async t=>{const e=r.calculatorInputs[t],a=r.calculatorResults[t];if(!e||!a){g.show("No calculation results to export","warning");return}if(!window.TillerPDF){g.show("PDF module not loaded","error");return}if(!await window.TillerPDF.waitForLibrary()){g.show("PDF library not loaded. Please refresh.","error");return}const o=r.activeProject?S.get(r.activeProject):null,i=o?o.name:"Quick Estimate",p=(o==null?void 0:o.shoppingList)||[];g.show("Generating PDF...","info");const l=await window.TillerPDF.downloadQuickEstimate(t,e,a,i,p);l.success?g.show(`Downloaded: ${l.filename}`,"success"):g.show(`PDF failed: ${l.error}`,"error")}},document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>$.init()):$.init()})();})();
