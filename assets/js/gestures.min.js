(()=>{class h{constructor(){this.init()}init(){this.initSwipeNavigation(),this.initLongPress(),this.initPinchZoom(),this.initWebShare()}initSwipeNavigation(){document.querySelectorAll(".portfolio-item, .gallery-item").forEach(e=>{let o=0,i=0,t=!1;e.addEventListener("touchstart",s=>{o=s.touches[0].clientX,i=s.touches[0].clientY,t=!0},{passive:!0}),e.addEventListener("touchmove",s=>{if(!t)return;const a=s.touches[0].clientX,c=s.touches[0].clientY,r=a-o,l=c-i;Math.abs(r)>Math.abs(l)&&Math.abs(r)>50&&s.preventDefault()}),e.addEventListener("touchend",s=>{if(!t)return;const a=s.changedTouches[0].clientX,c=s.changedTouches[0].clientY,r=a-o,l=c-i;Math.abs(r)>Math.abs(l)&&Math.abs(r)>100&&(r>0?this.navigatePortfolio(e,"prev"):this.navigatePortfolio(e,"next"),window.haptics&&window.haptics.trigger("swipe")),t=!1},{passive:!0})})}navigatePortfolio(n,e){const o=Array.from(document.querySelectorAll(".portfolio-item, .gallery-item")),i=o.indexOf(n);let t;e==="next"?t=(i+1)%o.length:t=(i-1+o.length)%o.length;const s=o[t];s&&s.scrollIntoView({behavior:"smooth",block:"nearest"})}initLongPress(){document.querySelectorAll(".portfolio-item img, .gallery-item img").forEach(e=>{let o,i,t;e.addEventListener("touchstart",s=>{i=s.touches[0].clientX,t=s.touches[0].clientY,o=setTimeout(()=>{this.showContextMenu(e,s.touches[0].clientX,s.touches[0].clientY),window.haptics&&window.haptics.trigger("longPress")},500)},{passive:!0}),e.addEventListener("touchmove",s=>{const a=s.touches[0].clientX,c=s.touches[0].clientY;Math.sqrt(Math.pow(a-i,2)+Math.pow(c-t,2))>10&&clearTimeout(o)},{passive:!0}),e.addEventListener("touchend",()=>{clearTimeout(o)},{passive:!0})})}showContextMenu(n,e,o){const i=document.querySelector(".gesture-context-menu");i&&i.remove();const t=document.createElement("div");t.className="gesture-context-menu",t.innerHTML=`
      <button class="context-menu-item" data-action="share">
        <span aria-hidden="true">\u{1F4E4}</span> Share
      </button>
      <button class="context-menu-item" data-action="download">
        <span aria-hidden="true">\u2B07\uFE0F</span> Download
      </button>
      <button class="context-menu-item" data-action="fullscreen">
        <span aria-hidden="true">\u{1F50D}</span> View Full Size
      </button>
    `,t.style.position="fixed",t.style.left=`${e}px`,t.style.top=`${o}px`,document.body.appendChild(t);const s=t.getBoundingClientRect();s.right>window.innerWidth&&(t.style.left=`${e-s.width}px`),s.bottom>window.innerHeight&&(t.style.top=`${o-s.height}px`),t.addEventListener("click",a=>{var r;const c=(r=a.target.closest("[data-action]"))==null?void 0:r.dataset.action;c==="share"?this.shareImage(n):c==="download"?this.downloadImage(n):c==="fullscreen"&&this.viewFullscreen(n),t.remove()}),setTimeout(()=>{document.addEventListener("click",a=>{t.contains(a.target)||t.remove()},{once:!0})},100)}initPinchZoom(){document.querySelectorAll(".portfolio-item img, .gallery-item img").forEach(e=>{let o=0,i=1;e.addEventListener("touchstart",t=>{t.touches.length===2&&(t.preventDefault(),o=this.getDistance(t.touches[0],t.touches[1]),e.style.transition="none")}),e.addEventListener("touchmove",t=>{if(t.touches.length===2){t.preventDefault();const a=this.getDistance(t.touches[0],t.touches[1])/o;i=Math.min(Math.max(a,.5),3),e.style.transform=`scale(${i})`}}),e.addEventListener("touchend",t=>{t.touches.length===0&&(e.style.transition="transform 0.3s ease",i<1&&(e.style.transform="scale(1)",i=1))})})}getDistance(n,e){const o=n.clientX-e.clientX,i=n.clientY-e.clientY;return Math.sqrt(o*o+i*i)}initWebShare(){document.querySelectorAll("[data-share]").forEach(e=>{if(!navigator.share){e.style.display="none";return}e.addEventListener("click",o=>{o.preventDefault();const i=e.dataset.shareUrl||window.location.href,t=e.dataset.shareTitle||document.title,s=e.dataset.shareText||"";this.share({url:i,title:t,text:s})})})}async share(n){if(!navigator.share){console.log("[Gestures] Web Share API not supported");return}try{await navigator.share({title:n.title,text:n.text,url:n.url}),console.log("[Gestures] Shared successfully"),window.haptics&&window.haptics.trigger("success"),typeof gtag!="undefined"&&gtag("event","share",{method:"web_share",content_type:"page",item_id:n.url})}catch(e){e.name!=="AbortError"&&console.error("[Gestures] Share failed:",e)}}async shareImage(n){const e=n.src,o=n.alt||"Tillerstead Portfolio Image";try{const t=await(await fetch(e)).blob(),s=new File([t],"tillerstead-portfolio.jpg",{type:t.type});await navigator.share({title:o,text:"Check out this tile installation by Tillerstead",files:[s]}),console.log("[Gestures] Image shared successfully")}catch(i){this.share({title:o,text:"Check out this tile installation by Tillerstead",url:window.location.href})}}downloadImage(n){const e=document.createElement("a");e.href=n.src,e.download=n.alt||"tillerstead-image",e.click(),window.haptics&&window.haptics.trigger("success")}viewFullscreen(n){n.requestFullscreen?n.requestFullscreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen(),window.haptics&&window.haptics.trigger("light")}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{new h}):new h;var d=h;})();
