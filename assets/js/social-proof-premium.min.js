(()=>{(function(){"use strict";class d{constructor(){this.activities=[],this.projectCount=0,this.reviewCount=0,this.init()}init(){this.setupLiveActivityFeed(),this.setupProjectCounter(),this.setupRecentReviews(),this.setupTrustBadges(),this.setupRealtimeNotifications()}setupLiveActivityFeed(){const e=[{type:"quote",text:"John D. just requested a quote",location:"Atlantic County",time:"3 min ago"},{type:"review",text:"Sarah M. left a 5-star review",location:"Ocean County",time:"12 min ago"},{type:"project",text:"New bathroom project started",location:"Cape May County",time:"25 min ago"},{type:"quote",text:"Mike R. used the tile calculator",location:"Atlantic County",time:"38 min ago"},{type:"completion",text:"Kitchen renovation completed",location:"Ocean County",time:"1 hour ago"}];this.activities=e,this.startActivityFeed()}startActivityFeed(){if(!document.getElementById("live-activity-feed"))return;let t=0;const o=()=>{const s=this.activities[t];this.showActivityNotification(s),t=(t+1)%this.activities.length};setTimeout(o,1e4),setInterval(()=>{Math.random()>.3&&o()},6e4+Math.random()*3e4)}showActivityNotification(e){const t=document.createElement("div");t.className="social-proof-notification",t.innerHTML=`
        <div class="notification-icon">${this.getActivityIcon(e.type)}</div>
        <div class="notification-content">
          <div class="notification-text">${e.text}</div>
          <div class="notification-meta">
            <span class="location">\u{1F4CD} ${e.location}</span>
            <span class="time">\u23F1\uFE0F ${e.time}</span>
          </div>
        </div>
        <button class="notification-close" onclick="this.parentElement.remove()">\xD7</button>
      `,document.body.appendChild(t),setTimeout(()=>t.classList.add("show"),100),setTimeout(()=>{t.classList.remove("show"),setTimeout(()=>t.remove(),300)},8e3)}getActivityIcon(e){return{quote:"\u{1F4CB}",review:"\u2B50",project:"\u{1F528}",completion:"\u2705",calculator:"\u{1F9EE}"}[e]||"\u{1F4CC}"}setupProjectCounter(){document.querySelectorAll("[data-counter]").forEach(t=>{const o=parseInt(t.dataset.target),s=parseInt(t.dataset.duration)||2e3;this.animateCounter(t,o,s)})}animateCounter(e,t,o){const i=t/(o/16);let n=0;const a=new IntersectionObserver(c=>{c.forEach(r=>{if(r.isIntersecting){const l=setInterval(()=>{n+=i,n>=t?(e.textContent=t.toLocaleString(),clearInterval(l)):e.textContent=Math.floor(n).toLocaleString()},16);a.unobserve(e)}})});a.observe(e)}setupRecentReviews(){this.rotateReviews()}rotateReviews(){const e=document.getElementById("review-carousel");if(!e)return;const t=e.querySelectorAll(".review-card");if(t.length===0)return;let o=0;setInterval(()=>{t[o].classList.remove("active"),o=(o+1)%t.length,t[o].classList.add("active")},6e3)}setupTrustBadges(){const e=[{id:"licensed",icon:"\u2713",text:"NJ Licensed HIC",tooltip:"New Jersey Home Improvement Contractor License"},{id:"insured",icon:"\u{1F6E1}\uFE0F",text:"Fully Insured",tooltip:"Comprehensive liability & workers comp insurance"},{id:"tcna",icon:"\u{1F4DC}",text:"TCNA Compliant",tooltip:"Work follows TCNA Handbook standards"},{id:"guarantee",icon:"\u2B50",text:"5-Year Guarantee",tooltip:"Workmanship guaranteed for 5 years"},{id:"reviews",icon:"\u{1F4AC}",text:"50+ 5-Star Reviews",tooltip:"Rated 5.0 on multiple platforms"}],t=document.getElementById("trust-badges");t&&(t.innerHTML=e.map(o=>`
          <div class="trust-badge" data-tooltip="${o.tooltip}">
            <span class="badge-icon">${o.icon}</span>
            <span class="badge-text">${o.text}</span>
          </div>
        `).join(""))}setupRealtimeNotifications(){this.showViewerCount(),this.showRecentActivity()}showViewerCount(){const e=3+Math.floor(Math.random()*5),t=document.getElementById("live-viewers");t&&(t.textContent=`\u{1F465} ${e} others viewing this page`,t.style.display="block")}showRecentActivity(){const e=["Someone from Atlantic County just requested a quote","A new 5-star review was just posted","Project completed in Ocean County this week","3 people are currently using the tile calculator"],t=document.getElementById("recent-activity-banner");if(!t)return;const o=e[Math.floor(Math.random()*e.length)];t.textContent=o,t.classList.add("show"),setTimeout(()=>{t.classList.remove("show")},6e3)}}class u{constructor(){this.init()}init(){this.setupImageComparison(),this.setupGalleryFilters(),this.setupLightbox()}setupImageComparison(){document.querySelectorAll(".before-after").forEach(t=>{const o=t.querySelector(".slider"),s=t.querySelector(".before"),i=t.querySelector(".after");if(!o||!s||!i)return;let n=!1;const a=c=>{const r=t.getBoundingClientRect(),l=(c-r.left)/r.width*100,p=Math.max(0,Math.min(100,l));o.style.left=`${p}%`,i.style.clipPath=`inset(0 ${100-p}% 0 0)`};o.addEventListener("mousedown",()=>{n=!0}),t.addEventListener("mousemove",c=>{n&&a(c.clientX)}),document.addEventListener("mouseup",()=>{n=!1}),o.addEventListener("touchstart",()=>{n=!0}),t.addEventListener("touchmove",c=>{n&&a(c.touches[0].clientX)}),document.addEventListener("touchend",()=>{n=!1}),a(rect.left+rect.width/2)})}setupGalleryFilters(){const e=document.querySelectorAll("[data-filter]"),t=document.querySelectorAll("[data-category]");e.forEach(o=>{o.addEventListener("click",()=>{const s=o.dataset.filter;e.forEach(i=>i.classList.remove("active")),o.classList.add("active"),t.forEach(i=>{s==="all"||i.dataset.category===s?(i.style.display="block",setTimeout(()=>i.classList.add("visible"),10)):(i.classList.remove("visible"),setTimeout(()=>i.style.display="none",300))})})})}setupLightbox(){document.querySelectorAll(".gallery-item img").forEach(t=>{t.addEventListener("click",()=>{this.openLightbox(t.src,t.alt)})})}openLightbox(e,t){const o=document.createElement("div");o.className="lightbox",o.innerHTML=`
        <div class="lightbox-content">
          <img src="${e}" alt="${t}">
          <button class="lightbox-close" onclick="this.parentElement.parentElement.remove()">\xD7</button>
        </div>
      `,document.body.appendChild(o),setTimeout(()=>o.classList.add("show"),10),o.addEventListener("click",s=>{s.target===o&&o.remove()})}}class m{constructor(){this.selectedDate=null,this.selectedTime=null,this.init()}init(){this.setupCalendar(),this.setupTimeSlots(),this.setupFormSubmission()}setupCalendar(){const e=document.getElementById("appointment-calendar");if(!e)return;const t=new Date,o=14;for(let s=1;s<=o;s++){const i=new Date(t);if(i.setDate(i.getDate()+s),i.getDay()===0)continue;const n=document.createElement("button");n.className="calendar-day",n.dataset.date=i.toISOString().split("T")[0],n.innerHTML=`
          <div class="day-name">${i.toLocaleDateString("en-US",{weekday:"short"})}</div>
          <div class="day-number">${i.getDate()}</div>
          <div class="day-month">${i.toLocaleDateString("en-US",{month:"short"})}</div>
        `,n.addEventListener("click",()=>{document.querySelectorAll(".calendar-day").forEach(a=>a.classList.remove("selected")),n.classList.add("selected"),this.selectedDate=n.dataset.date,this.loadTimeSlots(i)}),e.appendChild(n)}}loadTimeSlots(e){const t=document.getElementById("time-slots");if(!t)return;const o=this.getAvailableSlots(e);t.innerHTML=`
        <h4>Available Times for ${e.toLocaleDateString()}</h4>
        <div class="time-slots-grid">
          ${o.map(s=>`
            <button class="time-slot" data-time="${s}">
              ${this.formatTime(s)}
            </button>
          `).join("")}
        </div>
      `,t.querySelectorAll(".time-slot").forEach(s=>{s.addEventListener("click",()=>{t.querySelectorAll(".time-slot").forEach(i=>i.classList.remove("selected")),s.classList.add("selected"),this.selectedTime=s.dataset.time,this.enableBooking()})}),t.style.display="block"}getAvailableSlots(e){const t=[];for(let i=8;i<17;i++)t.push(`${i}:00`),i<16&&t.push(`${i}:30`);return t.filter(()=>Math.random()>.3)}formatTime(e){const[t,o]=e.split(":"),s=parseInt(t),i=s>=12?"PM":"AM";return`${s>12?s-12:s}:${o} ${i}`}enableBooking(){const e=document.getElementById("book-appointment");e&&(e.disabled=!1)}setupFormSubmission(){const e=document.getElementById("appointment-form");e&&e.addEventListener("submit",async t=>{t.preventDefault(),await this.bookAppointment(new FormData(e))})}async bookAppointment(e){const t=Object.fromEntries(e);t.date=this.selectedDate,t.time=this.selectedTime;try{(await fetch("/api/appointments/book",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok&&this.showConfirmation(t)}catch(o){console.error("Booking error:",o),alert("Failed to book appointment. Please call us directly.")}}showConfirmation(e){const t=document.getElementById("appointment-confirmation");t&&(t.querySelector(".confirmation-date").textContent=new Date(e.date).toLocaleDateString(),t.querySelector(".confirmation-time").textContent=this.formatTime(e.time),t.classList.add("show"))}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{window.socialProof=new d,window.beforeAfter=new u,window.scheduler=new m}):(window.socialProof=new d,window.beforeAfter=new u,window.scheduler=new m)})();})();
